<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JVM | 技术侦探</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <script charset="utf-8" async="async" src="/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/js/fingerprint2.min.js"></script>
    <script charset="utf-8" async="async" src="https://s9.cnzz.com/z_stat.php?id=1278232949&amp;web_id=1278232949"></script>
    <script>
              var _hmt = _hmt || [];
              (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?0b31b4c146bf7126aed5009e1a4a11c8";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
              })();
            </script>
    <meta name="description" content="技术并不是我们所追求的目的,而是技术创新世界">
    <meta property="article:modified_time" content="null">
    <meta property="og:title" content="JVM">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/java/%E8%A1%A5%E5%85%85/JVM.html">
    <meta name="twitter:title" content="JVM">
    <meta name="twitter:url" content="/java/%E8%A1%A5%E5%85%85/JVM.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="robots" content="all">
    <meta name="author" content="小傅哥">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="keywords" content="Java基础">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.ee4e0787.css" as="style"><link rel="preload" href="/assets/css/styles.css?v=1712123086861" as="style"><link rel="preload" href="/assets/js/cg-styles.js?v=1712123086861" as="script"><link rel="preload" href="/assets/js/cg-app.js?v=1712123086861" as="script"><link rel="preload" href="/assets/js/cg-4.js?v=1712123086861" as="script"><link rel="preload" href="/assets/js/cg-18.js?v=1712123086861" as="script"><link rel="preload" href="/assets/js/cg-1.js?v=1712123086861" as="script"><link rel="preload" href="/assets/js/cg-79.js?v=1712123086861" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.ee4e0787.css"><link rel="stylesheet" href="/assets/css/styles.css?v=1712123086861">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">技术侦探</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/javaSE基础/01_Java入门与开发环境搭建.html" class="nav-link">
  javaSE
</a></li><li class="dropdown-subitem"><a href="/java/javaWeb/01_Web开发基础.html" class="nav-link">
  javaWeb
</a></li><li class="dropdown-subitem"><a href="/java/JUC/1、JUC概述.html" class="nav-link">
  JUC
</a></li><li class="dropdown-subitem"><a href="/java/响应式编程/前置知识.html" class="nav-link">
  响应式编程
</a></li><li class="dropdown-subitem"><a href="/设计模式/概述/概述.html" class="nav-link">
  设计模式
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/jdbc/01_JDBC.html" class="nav-link">
  jdbc
</a></li><li class="dropdown-subitem"><a href="/db/mysql/Mysql基础/01_MySQL概述.html" class="nav-link">
  mysql
</a></li></ul></li><li class="dropdown-item"><h4>
          补充
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/补充/Retrofit2.html" class="nav-link">
  Retrofit2
</a></li><li class="dropdown-subitem"><a href="/java/补充/JVM.html" class="nav-link">
  jvm
</a></li><li class="dropdown-subitem"><a href="/java/补充/枚举.html" class="nav-link">
  枚举
</a></li><li class="dropdown-subitem"><a href="/java/补充/线程池.html" class="nav-link">
  线程池
</a></li><li class="dropdown-subitem"><a href="/java/补充/自定义注解.html" class="nav-link">
  自定义注解
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端/前端基础/01_HTML.html" class="nav-link">
  前端基础
</a></li><li class="dropdown-subitem"><a href="/前端/vue/01_ECMAScript6入门.html" class="nav-link">
  vue
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/DDD架构/01-ddd是什么.html" class="nav-link">
  DDD
</a></li><li class="dropdown-item"><!----> <a href="/框架/Mybatis/01_MyBatis快速入门.html" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><h4>
          Spring全家桶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Spring全家桶/Spring/01_SpringIOC和DI.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringMVC/01_SpringMVC快速入门及解析.html" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringBoot/01_SpringBoot_入门.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringCloudAlibaba/Nacos.html" class="nav-link">
  SpringCloudAlibaba
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/中间件/ElasticSearch/ElasticSearch.html" class="nav-link">
  中间件 | 自研轮子
</a></div><div class="nav-item"><a href="/部署/linux/01_Linux_安装.html" class="nav-link">
  部署|运维
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><span class="title">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/实战/商城/项目笔记.html" class="nav-link">
  锋迷铺子
</a></li><li class="dropdown-item"><!----> <a href="/实战/实用工具类/DocUtils.html" class="nav-link">
  实用工具类
</a></li><li class="dropdown-item"><!----> <a href="http://520.hjcwzx.top/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  研究生工作平台
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/更新日志/更新日志.html" class="nav-link">
  更新日志
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/javaSE基础/01_Java入门与开发环境搭建.html" class="nav-link">
  javaSE
</a></li><li class="dropdown-subitem"><a href="/java/javaWeb/01_Web开发基础.html" class="nav-link">
  javaWeb
</a></li><li class="dropdown-subitem"><a href="/java/JUC/1、JUC概述.html" class="nav-link">
  JUC
</a></li><li class="dropdown-subitem"><a href="/java/响应式编程/前置知识.html" class="nav-link">
  响应式编程
</a></li><li class="dropdown-subitem"><a href="/设计模式/概述/概述.html" class="nav-link">
  设计模式
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/jdbc/01_JDBC.html" class="nav-link">
  jdbc
</a></li><li class="dropdown-subitem"><a href="/db/mysql/Mysql基础/01_MySQL概述.html" class="nav-link">
  mysql
</a></li></ul></li><li class="dropdown-item"><h4>
          补充
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/补充/Retrofit2.html" class="nav-link">
  Retrofit2
</a></li><li class="dropdown-subitem"><a href="/java/补充/JVM.html" class="nav-link">
  jvm
</a></li><li class="dropdown-subitem"><a href="/java/补充/枚举.html" class="nav-link">
  枚举
</a></li><li class="dropdown-subitem"><a href="/java/补充/线程池.html" class="nav-link">
  线程池
</a></li><li class="dropdown-subitem"><a href="/java/补充/自定义注解.html" class="nav-link">
  自定义注解
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端/前端基础/01_HTML.html" class="nav-link">
  前端基础
</a></li><li class="dropdown-subitem"><a href="/前端/vue/01_ECMAScript6入门.html" class="nav-link">
  vue
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/DDD架构/01-ddd是什么.html" class="nav-link">
  DDD
</a></li><li class="dropdown-item"><!----> <a href="/框架/Mybatis/01_MyBatis快速入门.html" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><h4>
          Spring全家桶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Spring全家桶/Spring/01_SpringIOC和DI.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringMVC/01_SpringMVC快速入门及解析.html" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringBoot/01_SpringBoot_入门.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringCloudAlibaba/Nacos.html" class="nav-link">
  SpringCloudAlibaba
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/中间件/ElasticSearch/ElasticSearch.html" class="nav-link">
  中间件 | 自研轮子
</a></div><div class="nav-item"><a href="/部署/linux/01_Linux_安装.html" class="nav-link">
  部署|运维
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><span class="title">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/实战/商城/项目笔记.html" class="nav-link">
  锋迷铺子
</a></li><li class="dropdown-item"><!----> <a href="/实战/实用工具类/DocUtils.html" class="nav-link">
  实用工具类
</a></li><li class="dropdown-item"><!----> <a href="http://520.hjcwzx.top/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  研究生工作平台
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/更新日志/更新日志.html" class="nav-link">
  更新日志
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>补充</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/补充/Retrofit2.html" class="sidebar-link">Retrofit2学习</a></li><li><a href="/java/补充/JVM.html" class="active sidebar-link">JVM</a></li><li><a href="/java/补充/枚举.html" class="sidebar-link">枚举</a></li><li><a href="/java/补充/线程池.html" class="sidebar-link">线程池</a></li><li><a href="/java/补充/自定义注解.html" class="sidebar-link">自定义注解</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-default-content content__default"><h1 id="jvm"><a href="#jvm" class="header-anchor">#</a> JVM</h1> <h2 id="一、内存结构"><a href="#一、内存结构" class="header-anchor">#</a> 一、内存结构</h2> <h3 id="整体架构"><a href="#整体架构" class="header-anchor">#</a> 整体架构</h3> <p><img src="/assets/img/image-20211101152647500.77be0f92.png" alt="image-20211101152647500"></p> <h3 id="_1、程序计数器"><a href="#_1、程序计数器" class="header-anchor">#</a> 1、程序计数器</h3> <p>线程私有，不会发生内存溢出</p> <p><img src="/assets/img/image-20211103085227117.f0f68651.png" alt="image-20211103085227117"></p> <p>解释执行----&gt;cpu</p> <h4 id="作用"><a href="#作用" class="header-anchor">#</a> 作用</h4> <p>用于保存JVM中下一条所要执行的指令的地址</p> <h4 id="特点"><a href="#特点" class="header-anchor">#</a> 特点</h4> <ul><li>线程私有
<ul><li>CPU会为每个线程分配时间片，当当前线程的时间片使用完以后，CPU就会去执行另一个线程中的代码</li> <li>程序计数器是<strong>每个线程</strong>所<strong>私有</strong>的，当另一个线程的时间片用完，又返回来执行当前线程的代码时，通过程序计数器可以知道应该执行哪一句指令</li></ul></li> <li>不会存在内存溢出</li></ul> <h3 id="_2、虚拟机栈-栈-先进后出"><a href="#_2、虚拟机栈-栈-先进后出" class="header-anchor">#</a> 2、虚拟机栈    （栈，先进后出）</h3> <h4 id="_2-1-定义"><a href="#_2-1-定义" class="header-anchor">#</a> 2.1：定义</h4> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>- 每个线程运行需要的内存空间，称为**虚拟机栈**
- 每次调用方法时所占用的内存，称为**栈帧**
- 当前正在执行的方法  ，称为**活动栈帧**
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-2-演示"><a href="#_2-2-演示" class="header-anchor">#</a> 2.2：演示</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>stack</span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo1</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">method2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> c <span class="token operator">=</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
        <span class="token keyword">return</span> c<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200608150534.png" target="_blank" rel="noopener noreferrer"><img src="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200608150534.png" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="_2-3-问题解答"><a href="#_2-3-问题解答" class="header-anchor">#</a> 2.3：问题解答</h4> <ul><li><strong>垃圾回收是否涉及栈内存？</strong> <ul><li><strong>不需要。在方法执行完毕后，对应的栈帧就会被弹出栈。所以无需通过垃圾回收机制去回收内存。</strong></li></ul></li> <li><strong>栈内存的分配越大越好吗？</strong> <ul><li><strong>不是。因为物理内存是一定的，栈内存越大，可以支持更多的递归调用，但是可执行的线程数就会越少</strong>。</li></ul></li> <li><strong>方法内的局部变量是否是线程安全的？</strong> <ul><li><strong>如果方法内局部变量没有逃离方法的作用范围，则是线程安全的</strong></li> <li><strong>如果如果局部变量引用了对象，并逃离了方法的作用范围，则需要考虑线程安全问题</strong></li></ul></li></ul> <h4 id="_2-4-内存溢出-栈内存溢出-递归无退出"><a href="#_2-4-内存溢出-栈内存溢出-递归无退出" class="header-anchor">#</a> 2.4：内存溢出      （栈内存溢出，递归无退出 ）</h4> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>溢出发生原因：虚拟机栈中，栈帧过多（无限递归）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/image-20211030150937424.285099f3.png" alt="image-20211030150937424"></p> <p><strong>设置栈大小</strong></p> <p><img src="/assets/img/image-20211030150927523.bdb4892b.png" alt="image-20211030150927523"></p> <h4 id="_2-5-生产排查"><a href="#_2-5-生产排查" class="header-anchor">#</a> 2.5：生产排查</h4> <p>CPU占用过高    <strong>（使用top命令看cpu占用率，   ps 查看 哪个线程占用CPU过高,  jstack - 查看进程中的线程 ）</strong></p> <ul><li>Linux环境下运行某些程序的时候，可能导致CPU的占用过高，这时需要定位占用CPU过高的线程
<ul><li><strong>top</strong>命令，查看是哪个<strong>进程</strong>占用CPU过高</li> <li><strong>ps H -eo pid,tid,time,%cpu,cmd --sort=%cpu  | grep pid</strong>  通过ps命令进一步查看是哪个线程占用CPU过高</li> <li><strong>jstack -l 进程id</strong> 通过查看进程中的线程的nid，注意：jstack查找出的线程id是<strong>16进制的</strong>，<strong>需要转换</strong></li></ul></li></ul> <h3 id="_3、本地方法栈"><a href="#_3、本地方法栈" class="header-anchor">#</a> 3、本地方法栈</h3> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>一些带有native关键字的方法就是需要JAVA去调用本地的C或者C++方法，因为JAVA有时候没法直接和操作系统底层交互，所以需要用到本地方法
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/image-20211030150912247.3fd3b046.png" alt="image-20211030150912247"></p> <p><img src="/assets/img/image-20211030150859334.e57710c5.png" alt="image-20211030150859334"></p> <h3 id="_4、堆-对象-数组-枚举"><a href="#_4、堆-对象-数组-枚举" class="header-anchor">#</a> 4、堆      （对象，数组，枚举）</h3> <h4 id="_4-1-定义"><a href="#_4-1-定义" class="header-anchor">#</a> 4.1：定义</h4> <blockquote><p>Student stu(栈) =   new Student()（堆）</p></blockquote> <blockquote><p>通过new关键字<strong>创建的对象</strong>都会被放在堆内存</p></blockquote> <h4 id="_4-2-特点"><a href="#_4-2-特点" class="header-anchor">#</a> 4.2：特点</h4> <ul><li><strong>所有线程共享</strong>，<strong>堆内存中的对象都需要考虑线程安全问题</strong>         对象的线程同步</li> <li><strong>有垃圾回收机制</strong></li></ul> <h4 id="_4-3-堆内存溢出"><a href="#_4-3-堆内存溢出" class="header-anchor">#</a> 4.3：堆内存溢出</h4> <p><img src="/assets/img/image-20211030150842076.a51324de.png" alt="image-20211030150842076"></p> <p><strong>设置堆大小</strong></p> <blockquote><p>Unless the initial and maximum heap sizes are specified on the command line, they are calculated based on the amount of memory on the machine.</p> <ul><li><h6 id="最大堆大小-物理内存小于192mb时-为物理内存的一半-物理内存大192mb且小于1gb时-为物理内存的四分之一-大于等于1gb时-都为256mb"><a href="#最大堆大小-物理内存小于192mb时-为物理内存的一半-物理内存大192mb且小于1gb时-为物理内存的四分之一-大于等于1gb时-都为256mb" class="header-anchor">#</a> 最大堆大小：物理内存小于192MB时，为物理内存的一半；物理内存大192MB且小于1GB时，为物理内存的四分之一；大于等于1GB时，都为256MB</h6></li> <li><p><strong>初始化堆大小：至少为8MB；物理内存大于512MB且小于1GB时，为物理内存的六十四分之一；大于等于1GB时，都为16MB</strong></p></li> <li><p>-Xms  初始堆大小   -Xmn 最小堆大小   -Xmx 最大堆大小</p></li></ul></blockquote> <p><img src="/assets/img/image-20211030150823973.78420f5e.png" alt="image-20211030150823973"></p> <h4 id="_4-4-堆内存诊断"><a href="#_4-4-堆内存诊断" class="header-anchor">#</a> 4.4：堆内存诊断</h4> <p><strong>jps</strong>         （查看进程）</p> <p>**jmap -heap 进程id   （查看堆内存使用情况） **         堆： 新生代 （1）  和老年代 （2）</p> <p>​                                                     伊甸区（8） 、 S0（1）、 S1（1）</p> <p>​</p> <p><strong>jconsole 进程id</strong>         windows下运行      HeapDemo2</p> <p><strong>jvirsalvm 进程id</strong>   堆dump搜索占用内存的数据    ，不用了</p> <blockquote><p><em>VisualVM</em> 是一款免费的，集成了多个 JDK 命令行工具的可视化工具，提供强大的分析能力，对 Java 应用程序做性能分析和调优。</p> <p>在高版本JDK（大于1.8或后期更新的1.8版本）中已经不会再自动集成 <em>VisualVM</em></p></blockquote> <h3 id="_5-arthas-jvm诊断工具"><a href="#_5-arthas-jvm诊断工具" class="header-anchor">#</a> 5.Arthas        (JVM诊断工具)</h3> <p><strong>栈内存：thread -n 1   查找到最耗CPU的线程</strong></p> <p><strong>堆内存：heapdump  查找对象生成文件，jhat  启动打开文件</strong></p> <blockquote><p>文档：https://arthas.aliyun.com/doc/</p></blockquote> <h4 id="_5-1-arthas功能"><a href="#_5-1-arthas功能" class="header-anchor">#</a> 5.1：Arthas功能</h4> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>
这个类从哪个 jar 包加载的？为什么会报各种类相关的 Exception？
我改的代码为什么没有执行到？难道是我没 commit？分支搞错了？
遇到问题无法在线上 debug，难道只能通过加日志再重新发布吗？
线上遇到某个用户的数据处理有问题，但线上同样无法 debug，线下无法重现！
是否有一个全局视角来查看系统的运行状况？
有什么办法可以监控到JVM的实时运行状态？
怎么快速定位应用的热点，生成火焰图？
怎样直接从JVM内查找某个类的实例？
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_5-2-arthas安装-查看jvm的运行情况"><a href="#_5-2-arthas安装-查看jvm的运行情况" class="header-anchor">#</a> 5.2：Arthas安装        （查看JVM的运行情况）</h4> <p><strong>在线安装</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>
curl -O https://arthas.aliyun.com/arthas-boot.jar
java -jar arthas-boot.jar

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>离线安装</strong></p> <p>最新版本，点击下载：<a href="https://arthas.aliyun.com/download/latest_version?mirror=aliyun" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/maven-central/v/com.taobao.arthas/arthas-packaging.svg?style=flat-square" alt="Arthas"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>解压后，在文件夹里有<code>arthas-boot.jar</code>，直接用<code>java -jar</code>的方式启动：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>java -jar arthas-boot.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>通过浏览器操作</strong></p> <p><img src="/assets/img/image-20211030150753525.7864f2ad.png" alt="image-20211030150753525"></p> <h4 id="_5-3-命令简介"><a href="#_5-3-命令简介" class="header-anchor">#</a> 5.3：命令简介</h4> <p>dashboard 演示</p> <p><img src="/assets/img/image-20211030150809190.884bfd70.png" alt="image-20211030150809190"></p> <h4 id="_5-5-cpu排查-栈内存"><a href="#_5-5-cpu排查-栈内存" class="header-anchor">#</a> 5.5：CPU排查      （栈内存）</h4> <blockquote><p>排查哪个线程最消耗CPU资源</p></blockquote> <p>先通过top命令找到最耗CPU的进程id</p> <p>再通过arthas 监测该进程</p> <p>通过thread -n 1   查找到最耗CPU的线程</p> <h4 id="_5-4-排查内存消耗-堆内存"><a href="#_5-4-排查内存消耗-堆内存" class="header-anchor">#</a> 5.4：排查内存消耗    （堆内存）</h4> <blockquote><p>分析堆内存为什么占用这么高</p></blockquote> <p>通过top找到消耗内存的进程</p> <p>开启arthas</p> <p>heapdump --live  /usr/local/dump.hprof    （arthas的命令）</p> <p>jhat dump.hprof</p> <p>通过ip+端口访问      虚拟机:7000</p> <h3 id="_6、方法区-存的是类的结构"><a href="#_6、方法区-存的是类的结构" class="header-anchor">#</a> 6、方法区    （存的是类的结构）</h3> <p>常量和静态变量也是放在方法区中的</p> <p>方法区定义：https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-2.html</p> <h4 id="_6-1-结构"><a href="#_6-1-结构" class="header-anchor">#</a> 6.1：结构</h4> <p><img src="/assets/img/image-20211031113159340.cad4dcc7.png" alt="image-20211031113159340"></p> <h4 id="_6-2-内存溢出"><a href="#_6-2-内存溢出" class="header-anchor">#</a> 6.2：内存溢出</h4> <ul><li><p>1.8以前会导致<strong>永久代</strong>内存溢出</p> <p>-XX:MaxPermSize=64m 来设定永久代最大可分配空间。32 位机器默认是64M ，64位机器模式是 82M</p></li> <li><p>1.8以后会导致<strong>元空间</strong>内存溢出</p> <p><code>-XX:MetaspaceSize</code>=21m和<code>-XX:MaxMetaspaceSize=-1</code>  （不设限制）</p></li></ul> <h4 id="_6-3-常量池"><a href="#_6-3-常量池" class="header-anchor">#</a> 6.3：常量池</h4> <p>通过javap指令可以查看字节码文件中类的基本信息、常量池、类的方法定义（包含了虚拟机指令）</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>F:\JVM\代码\jvm\target\classes\com\methodarea&gt;javap -v MethodAreaDemo1.class
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>解释器查表翻译：</strong></p> <p><img src="/assets/img/image-20211031103334801.1a88bc01.png" alt="image-20211031103334801"></p> <ul><li>常量池
<ul><li>就是一张常量表（constant pool），虚拟机指令根据这张常量表找到要执行的类名、方法名、参数类型、字面量信息</li></ul></li> <li>运行时常量池
<ul><li>常量池是*.class文件中的，当该<strong>类被加载以后</strong>，它的常量池信息就会<strong>放入运行时常量池</strong>，并把里面的<strong>符号地址变为真实地址</strong></li></ul></li></ul> <h4 id="_6-4-stringtable串池"><a href="#_6-4-stringtable串池" class="header-anchor">#</a> 6.4：StringTable串池</h4> <p>StringTable.class</p> <h5 id="_6-4-1-字符串赋值过程"><a href="#_6-4-1-字符串赋值过程" class="header-anchor">#</a> 6.4.1：字符串赋值过程</h5> <p><img src="/assets/img/image-20211031104745374.e8c74c15.png" alt="image-20211031104745374"></p> <h5 id="_6-4-2-字符串拼接过程1"><a href="#_6-4-2-字符串拼接过程1" class="header-anchor">#</a> 6.4.2：字符串拼接过程1</h5> <p><img src="/assets/img/image-20211031105654599.c1b5f208.png" alt="image-20211031105654599"></p> <h5 id="_6-4-2-字符串拼接过程2"><a href="#_6-4-2-字符串拼接过程2" class="header-anchor">#</a> 6.4.2：字符串拼接过程2</h5> <blockquote><div class="language- line-numbers-mode"><pre class="language-text"><code>String var5 = &quot;hello&quot;+&quot;world&quot;; //编译期间优化    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></blockquote> <p>String var1= &quot;hello&quot;,var2=&quot;world&quot;;</p> <p>​    String var4 = var1+var2 和 String var5=  &quot;hello&quot;+&quot;world&quot;和 String var6=var1+&quot;world&quot;</p> <h5 id="_6-4-3-字符串intern方法"><a href="#_6-4-3-字符串intern方法" class="header-anchor">#</a> 6.4.3：字符串intern方法</h5> <blockquote><p>作用：将字符串对象强制放入串池，并返回串池的对象引用</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> var1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//对象在堆中</span>
<span class="token class-name">String</span> var2 <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span><span class="token comment">//对象在串池中</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>var1 <span class="token operator">==</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span>




<span class="token class-name">String</span> var1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//对象在堆中</span>
<span class="token class-name">String</span> var2 <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span><span class="token comment">//对象在串池中</span>
<span class="token class-name">String</span> var3 <span class="token operator">=</span> var1<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//var3在串池中</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>var1 <span class="token operator">==</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>var3 <span class="token operator">==</span> var2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>var3 <span class="token operator">==</span> var1<span class="token punctuation">)</span><span class="token punctuation">;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h5 id="_6-4-4-串池所处的位置"><a href="#_6-4-4-串池所处的位置" class="header-anchor">#</a> 6.4.4：串池所处的位置</h5> <p><img src="/assets/img/image-20211031113207964.cad4dcc7.png" alt="image-20211031113207964"></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>转移到堆的原因
永久代只有fullgc才会进行垃圾回收，如果放在永久代的方法区，会导致内存溢出
放入堆中，堆会频繁gc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>小结</strong></p> <ul><li>常量池中的字符串仅是符号，只有<strong>在被用到时才会转化为对象</strong></li> <li>利用串池的机制，来避免重复创建字符串对象</li> <li>字符串<strong>变量</strong>拼接的原理是<strong>StringBuilder</strong></li> <li>字符串<strong>常量</strong>拼接的原理是<strong>编译器优化</strong></li> <li>可以使用<strong>intern方法</strong>，主动将串池中还没有的字符串对象放入串池中</li> <li><strong>注意</strong>：无论是串池还是堆里面的字符串，都是对象用来放字符串对象且里面的<strong>元素不重复</strong></li></ul> <h2 id="二-垃圾回收"><a href="#二-垃圾回收" class="header-anchor">#</a> 二：垃圾回收</h2> <h3 id="_2-1-怎么判断垃圾"><a href="#_2-1-怎么判断垃圾" class="header-anchor">#</a> 2.1：怎么判断垃圾</h3> <p><strong>引用计数</strong>：</p> <p><img src="data:image/png;base64,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" alt="image-20211031114846113"></p> <p><strong>弊端：内存不能回收，导致内存泄漏</strong></p> <p><strong>可达分析</strong>：</p> <p><img src="/assets/img/image-20211031115314792.ef089cf5.png" alt="image-20211031115314792"></p> <p><strong>GC Roots 到底是什么东西呢，哪些对象可以作为 GC Root 呢？</strong></p> <ul><li>虚拟机栈（栈帧中的本地变量表）中引用的对象</li> <li>本地方法栈中 JNI（即一般说的 Native 方法）引用的对象</li> <li>方法区中类静态属性引用的对象</li> <li>方法区中常量引用的对象</li></ul> <h3 id="_2-2-引用"><a href="#_2-2-引用" class="header-anchor">#</a> 2.2：引用</h3> <blockquote><p>为了充分利用计算机的内存，对象被设计成拥有生命周期。当对象的生命周期结束，会被垃圾回收器回收，从而释放内存资源。为了考虑回收的各种场景，在JDK1.2引用了强、软、弱、虚4种引用类型。</p></blockquote> <p><img src="/assets/img/image-20211031122852017.c5d2895f.png" alt="image-20211031122852017"></p> <p><strong>强引用</strong></p> <p>如果一个对象是强引用，那么垃圾回收器不会轻易回收它。只用当这个对象没有被使用，垃圾回收器才会回收它。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//强引用</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> a <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Student</span> stu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    stu <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>软引用</strong></p> <p>当系统内存不足时，会触发GC。当垃圾回收后，内存还是不足，就会把软引用的包裹的对象给清理掉。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token comment">//软引用</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> ref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoftReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
        student <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//只要内存够不会回收</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//内存不够回收</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span>  data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><strong>弱引用</strong></p> <p>如果触发GC，这时内存很充足，但是被弱引用的对象还是会被回收。所以说，被弱引用关联的对象只能生存到下一次垃圾收集发生之前。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code> <span class="token comment">//弱引用</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Student</span> student <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> ref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>student<span class="token punctuation">)</span><span class="token punctuation">;</span>
        student <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">gc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>虚引用</strong></p> <p>这就是虚引用有几个特点：</p> <ul><li>虚引用必须与<code>ReferenceQueue</code>一起使用，当GC准备回收一个对象，如果发现它还有虚引用，就会在回收之前，把这个虚引用加入到与之关联的<code>ReferenceQueue</code>中。</li> <li>虚引用可以跟踪对象的回收情况</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span>  <span class="token keyword">static</span> <span class="token keyword">void</span>  <span class="token function">d</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">ReferenceQueue</span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">PhantomReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Student</span><span class="token punctuation">&gt;</span></span> ref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhantomReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>queue<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>ref<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-3-垃圾回收算法"><a href="#_2-3-垃圾回收算法" class="header-anchor">#</a> 2.3：垃圾回收算法</h3> <h4 id="_2-3-1-标记清除"><a href="#_2-3-1-标记清除" class="header-anchor">#</a> 2.3.1：标记清除</h4> <p><img src="/assets/img/image-20211031123940019.ff248dc9.png" alt="image-20211031123940019"></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>标记无用对象，然后进行清除回收
优点：效率快
缺点：内存碎片
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-3-2-标记整理"><a href="#_2-3-2-标记整理" class="header-anchor">#</a> 2.3.2：标记整理</h4> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>标记无用对象，让所有存活的对象都向一端移动，然后直接清除掉端边界以外的内存。
优点：避免内存碎片
缺点：效率低
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/image-20211031124351879.3a84742c.png" alt="image-20211031124351879"></p> <h4 id="_2-3-3-复制"><a href="#_2-3-3-复制" class="header-anchor">#</a> 2.3.3：复制</h4> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>按照容量划分二个大小相等的内存区域，当一块用完的时候将活着的对象复制到另一块上，然后再把已使用的内存空间一次清理掉。
优点：避免内存碎片，效率相对页可以。
缺点：内存使用率不高，只有原来的一半。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/image-20211031125259969.787eaec8.png" alt="image-20211031125259969"></p> <h4 id="_2-3-4-分代回收"><a href="#_2-3-4-分代回收" class="header-anchor">#</a> 2.3.4：分代回收</h4> <p>https://www.processon.com/diagraming/5febdd235653bb6b1b4f5bd6</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>分代回收算法是目前使用较多的一种算法，这个不是一个新的算法，只是将内存进行的划分，不同区域的内存使用不同的算法。
在新生代中使用是复制算法，在进行对象内存分配的时候只会使用 Eden 和 S0 区，当发生 GC 的时候，会将存活的对象复制到 S1 区，然后循环往复进行复制。
当某个对象在进行了 15 次GC 后依旧存活，那这个对象就会进入老年代。老年代因为每次回收的对象都会比较少，因此使用的是标记整理算法。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-3-5-jvm参数"><a href="#_2-3-5-jvm参数" class="header-anchor">#</a> 2.3.5：JVM参数</h4> <table><thead><tr><th>含义</th> <th>参数</th> <th>eg</th></tr></thead> <tbody><tr><td>堆初始大小</td> <td>Xms</td> <td><strong>-Xms512m</strong></td></tr> <tr><td>堆最大大小</td> <td>-Xmx 或 -XX:MaxHeapSize=size</td> <td><strong>-Xmx512m</strong></td></tr> <tr><td>新生代大小</td> <td>-Xmn 或 (-XX:NewSize=size + -XX:MaxNewSize=size )</td> <td><strong>-Xmn200m</strong></td></tr> <tr><td>幸存区比例（动态）</td> <td>XX:InitialSurvivorRatio=ratio 和 -XX:+UseAdaptiveSizePolicy</td> <td><strong>XX:SurvivorRatio=8，伊甸园区、幸存者0区和幸存者1区比例为： 8:1:1</strong></td></tr> <tr><td>幸存区比例</td> <td>-XX:SurvivorRatio=ratio</td> <td>-XX:SurvivorRatio=8</td></tr> <tr><td>晋升阈值</td> <td>-XX:MaxTenuringThreshold=threshold</td> <td>-XX:MaxTenuringThreshold=15</td></tr> <tr><td>晋升详情</td> <td>XX:+PrintTenuringDistribution</td> <td></td></tr> <tr><td>GC详情</td> <td>-XX:+PrintGCDetails -verbose:gc</td> <td></td></tr> <tr><td>FullGC 前 MinorGC</td> <td>-XX:+ScavengeBeforeFullGC</td> <td></td></tr></tbody></table> <h3 id="_2-4-垃圾回收器"><a href="#_2-4-垃圾回收器" class="header-anchor">#</a> 2.4：垃圾回收器</h3> <p><img src="/assets/img/image-20211101141509606.18bad6f9.png" alt="image-20211101141509606"></p> <h4 id="_2-4-1-串行"><a href="#_2-4-1-串行" class="header-anchor">#</a> 2.4.1：串行</h4> <p><strong>开启方式：</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>XX:+UseSerialGC = Serial + SerialOld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>运行原理</strong></p> <p>​                                                                            stw<img src="/assets/img/image-20211101141642878.ffa8f889.png" alt="image-20211101141642878"></p> <p><strong>应用场景:</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>单核CPU
堆内存较小，适合个人电脑
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-4-2-吞吐量优先"><a href="#_2-4-2-吞吐量优先" class="header-anchor">#</a> 2.4.2：吞吐量优先</h4> <blockquote><p>吞吐量=用户线程执行时间/(用户线程执行时间+垃圾收集时间)。</p> <p>虚拟机总共运行100分钟，其中垃圾收集花费时间1分钟，那么吞吐量就是 99%</p></blockquote> <p><strong>开启方式：</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>-XX:+UseParallelGC 
-XX:+UseParallelOldGC
-XX:ParallelGCThreads=n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>运行原理</strong></p> <p><img src="/assets/img/image-20211101142618935.b4de9e5b.png" alt="image-20211101142618935"></p> <p><strong>应用场景:</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>堆内存较大，多核 cpu
适用于后台计算型任务程序
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-4-3-响应时间优先"><a href="#_2-4-3-响应时间优先" class="header-anchor">#</a> 2.4.3：响应时间优先</h4> <blockquote><p>单次 STW 的时间最短</p></blockquote> <p><strong>开启方式：</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>-XX:+UseConcMarkSweepGC 
-XX:+UseParNewGC
-XX:ConcGCThreads=threads

并发（Concurrent），多个线程抢占CPU资源，不是真正意义的同时进行
并行（Parallel），当系统有一个以上CPU时，当一个CPU执行一个进程时，另一个CPU可以执行另一个进程，两个进程互不抢占CPU资源，可以同时进行，真正意义的同时进行
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>运行原理：</strong></p> <p><img src="/assets/img/image-20211101143122349.dcad03b1.png" alt="image-20211101143122349"></p> <p><strong>应用场景：</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>堆内存较大，多核 cpu
在互联网网站、B/S架构的中常用的收集器就是CMS，因为系统停顿的时间最短，给用户带来较好的体验
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-4-4-g1"><a href="#_2-4-4-g1" class="header-anchor">#</a> 2.4.4：G1</h4> <blockquote><table><thead><tr><th>-XX:+UseG1GC</th> <th>使用 G1 (Garbage First) 垃圾收集器</th></tr></thead> <tbody><tr><td>-XX:MaxGCPauseMillis=n</td> <td>设置最大GC停顿时间(GC pause time)指标(target). 这是一个软性指标(soft goal), JVM 会尽量去达成这个目标.</td></tr></tbody></table></blockquote> <p><strong>1：简介</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>1.所有的垃圾回收器的目的都是朝着减少STW的目的而前进。
2.G1(Garbage First)回收器的出现颠覆了之前版本CMS、Parallel等垃圾回收器的分代收集方式，从2004年Sun发3.布第一篇关于G1的论文后，直到2012年JDK7发布更新版本，花了将近10年的时间G1才达到商用的程度。
4.到JDK9发布之后，G1成为了默认的垃圾回收器，CMS也变相地相当于被淘汰了。
5.G1能管理超大堆内存的垃圾回收      

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>一共有4种Region：</p> <p>分治</p> <ol><li>自由分区Free Region</li> <li>年轻代分区Young Region，年轻代还是会存在Eden和Survivor的区分</li> <li>老年代分区Old Region</li> <li>大对象分区Humongous Region</li></ol></blockquote> <p>每个Region的大小通过<code>-XX:G1HeapRegionSize</code>来设置，大小为1~32MB，默认最多可以有2048个Region，那么按照默认值计算G1能管理的最大内存就是32MB*2048=64G。</p> <p>对于大对象的存储，存在Humongous概念，对G1来说，超过一个Region一半大小的对象都被认为大对象，将会被放入Humongous Region，而对于超过整个Region的大对象，则用几个连续的Humongous来存储（如下图H区域）。</p> <p><img src="/assets/img/image-20211102162838508.c206ac67.png" alt="image-20211102162838508"></p> <p><strong>2：怎么分region</strong></p> <p>既然G1还是存在新生代和老年代的概念，那么新生代和老年代的空间是怎么划分的呢？</p> <p><img src="/assets/img/image-20211102163701341.bdd023c8.png" alt="image-20211102163701341"></p> <p>假设现在我们的堆空间大小是4G，按照默认最大2048个Region计算，每个Region的大小就是2M。</p> <p>初始新生代的大小那么就是200M，大约100个Region格子，动态扩展最大就是60%*4G=2.4G大小。</p> <h3 id="_2-5-调优"><a href="#_2-5-调优" class="header-anchor">#</a> 2.5：调优</h3> <blockquote><p>最好的GC调优是没有GC</p></blockquote> <h5 id="_2-5-1-内存泄漏"><a href="#_2-5-1-内存泄漏" class="header-anchor">#</a> 2.5.1：内存泄漏</h5> <blockquote><p>对象不再被程序使用，但是GC又不能回收他们</p></blockquote> <p><strong>1：大量使用静态变量</strong></p> <p>静态变量的生命周期与程序一致。因此常驻内存。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StaticTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">populateList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;running......&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;before......&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">new</span> <span class="token class-name">StaticTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">populateList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;after......&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>2：连接资源未关闭</strong></p> <p>每当建立一个连接，jvm就会为这么资源分配内存。比如数据库连接、文件输入输出流、网络连接等等。</p> <p><strong>3:ThreadLocal与内存泄漏</strong></p> <p><img src="/assets/img/image-20211101200829030.ad5503ef.png" alt="image-20211101200829030"></p> <p>为什么要将Entry中的key设为弱引用？</p> <p>设置为弱引用的key能预防大多数内存泄漏的情况。如果key 使用强引用，引用的ThreadLocal的对象被回收了，但是ThreadLocalMap还持有ThreadLocal的强引用，如果没有手动删除，ThreadLocal不会被回收，导致Entry内存泄漏。如果key为弱引用，引用的ThreadLocal的对象被回收了，由于ThreadLocalMap持有ThreadLocal的弱引用，即使没有手动删除，ThreadLocal也会被GC回收。value在下一次ThreadLocalMap调用set,get,remove的时候会被清除。</p> <p>若当前线程一直不结束，可能是作为线程池中的一员，线程结束后不被销毁，或者分配（当前线程又创建了ThreadLocal对象）使用了又不再调用get/set方法，就可能引发内存泄漏。</p> <h5 id="_2-5-2-大表查询"><a href="#_2-5-2-大表查询" class="header-anchor">#</a> 2.5.2：大表查询</h5> <p>select  name  from tbl   limit</p> <p>Resultset  (堆)</p> <h5 id="_2-5-3-面试"><a href="#_2-5-3-面试" class="header-anchor">#</a> 2.5.3：面试</h5> <p><strong>JVM内存结构：</strong></p> <p><strong>线程私有： 虚拟机栈，程序计数器，本地方法栈</strong></p> <p><strong>线程公有： 堆 ，本地方法区</strong></p> <ul><li><strong>垃圾回收是否涉及栈内存？</strong> <ul><li><strong>不需要。在方法执行完毕后，对应的栈帧就会被弹出栈。所以无需通过垃圾回收机制去回收内存。</strong></li></ul></li> <li><strong>栈内存的分配越大越好吗？</strong> <ul><li><strong>不是。因为物理内存是一定的，栈内存越大，可以支持更多的递归调用，但是可执行的线程数就会越少</strong>。</li></ul></li> <li><strong>方法内的局部变量是否是线程安全的？</strong> <ul><li><strong>如果方法内局部变量没有逃离方法的作用范围，则是线程安全的</strong></li> <li><strong>如果如果局部变量引用了对象，并逃离了方法的作用范围，则需要考虑线程安全问题</strong></li></ul></li></ul> <p><strong>栈内存诊断命令：top命令(查看是哪个进程占用CPU过高)  jstack -l 进程id 通过查看进程中的线程的nid</strong></p> <p><strong>堆内存诊断命令： jps（查看进程）     jmap -heap 进程id 查看堆内存使用情况</strong></p> <p><strong>JVM诊断工具 (Arthas)</strong></p> <p><strong>栈内存：thread -n 1   查找到最耗CPU的线程</strong></p> <p><strong>堆内存：heapdump  查找对象生成文件，jhat  启动打开文件</strong></p> <p><strong>串池，面试题：</strong></p> <p><strong>String var1= &quot;hello&quot;,var2=&quot;world&quot;;</strong><br> <strong>String var4 = var1+var2 和 String var5=  &quot;hello&quot;+&quot;world&quot;和 String var6=var1+&quot;world&quot;</strong></p> <p><strong>intern方法，将堆内存中的字符串放到串池中</strong></p> <p><strong>String s1=&quot;hello&quot;;</strong></p> <p><strong>String s2 = new String(&quot;hello&quot;);</strong></p> <p><strong>String s3 = s2.intern();</strong></p> <p><strong>s1==s2?     不等于</strong></p> <p><strong>s1==s3?     等于</strong></p> <p><strong>怎么判断垃圾？ 引用计数（产生内存泄露）</strong></p> <p><strong>可达分析</strong></p> <p><strong>类型：</strong></p> <p><strong>强 ：引用关系存在就对象不会回收</strong></p> <p><strong>软： 当内存不足，gc时对象会被回收</strong></p> <p><strong>弱:  只要gc，对象就回收</strong></p> <p><strong>虚：无法获取对象，为了跟踪对象的回收情况</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2024/1/22</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/java/补充/Retrofit2.html" class="prev">
          Retrofit2学习
        </a></span> <span class="next"><a href="/java/补充/枚举.html">
          枚举
        </a>
        →
      </span></p></div> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><div class="option-box-toc-fixed"><div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">JVM</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#一、内存结构" class="toc-sidebar-link">一、内存结构</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#整体架构" class="toc-sidebar-link">整体架构</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_1、程序计数器" class="toc-sidebar-link">1、程序计数器</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2、虚拟机栈-栈-先进后出" class="toc-sidebar-link">2、虚拟机栈    （栈，先进后出）</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_3、本地方法栈" class="toc-sidebar-link">3、本地方法栈</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_4、堆-对象-数组-枚举" class="toc-sidebar-link">4、堆      （对象，数组，枚举）</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_5-arthas-jvm诊断工具" class="toc-sidebar-link">5.Arthas        (JVM诊断工具)</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_6、方法区-存的是类的结构" class="toc-sidebar-link">6、方法区    （存的是类的结构）</a></li></ul></li><li><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#二-垃圾回收" class="toc-sidebar-link">二：垃圾回收</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-1-怎么判断垃圾" class="toc-sidebar-link">2.1：怎么判断垃圾</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-2-引用" class="toc-sidebar-link">2.2：引用</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-3-垃圾回收算法" class="toc-sidebar-link">2.3：垃圾回收算法</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-4-垃圾回收器" class="toc-sidebar-link">2.4：垃圾回收器</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-5-调优" class="toc-sidebar-link">2.5：调优</a></li></ul></li></ul></div></div></div></div></div> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">JVM</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#一、内存结构" class="toc-sidebar-link">一、内存结构</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#整体架构" class="toc-sidebar-link">整体架构</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_1、程序计数器" class="toc-sidebar-link">1、程序计数器</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2、虚拟机栈-栈-先进后出" class="toc-sidebar-link">2、虚拟机栈    （栈，先进后出）</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_3、本地方法栈" class="toc-sidebar-link">3、本地方法栈</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_4、堆-对象-数组-枚举" class="toc-sidebar-link">4、堆      （对象，数组，枚举）</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_5-arthas-jvm诊断工具" class="toc-sidebar-link">5.Arthas        (JVM诊断工具)</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_6、方法区-存的是类的结构" class="toc-sidebar-link">6、方法区    （存的是类的结构）</a></li></ul></li><li><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#二-垃圾回收" class="toc-sidebar-link">二：垃圾回收</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-1-怎么判断垃圾" class="toc-sidebar-link">2.1：怎么判断垃圾</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-2-引用" class="toc-sidebar-link">2.2：引用</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-3-垃圾回收算法" class="toc-sidebar-link">2.3：垃圾回收算法</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-4-垃圾回收器" class="toc-sidebar-link">2.4：垃圾回收器</a></li><li class="toc-sidebar-sub-header"><a href="/java/%E8%A1%A5%E5%85%85/JVM.html#_2-5-调优" class="toc-sidebar-link">2.5：调优</a></li></ul></li></ul></div></div></div></div></div> <div class="option-box"><img src="/images/system/wechat.png" class="nozoom"> <span class="show-txt">手机看</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.9rem">微信扫一扫</span> <img height="180px" src="https://api.qrserver.com/v1/create-qr-code/?data=https://tec.hjcwzx.top/java/%E8%A1%A5%E5%85%85/JVM.html" style="margin:10px;">
                可以<b>手机看</b>或分享至<b>朋友圈</b></div></div></div></div> <div class="option-box"><img src="/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <div class="option-box"><img src="/images/system/xingqiu.png" width="25px" class="nozoom"> <span class="show-txt">星球</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><img height="180px" src="/images/personal/xingqiu.png" style="margin:10px;"> <b>知识星球</b>：技术侦探
            </div></div></div></div> <div class="option-box"><img src="/images/system/wexin4.png" width="25px" class="nozoom"> <span class="show-txt">交流</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">添加微信一起学习交流</span> <img src="/images/personal/weixin.png" height="180px" style="margin:10px;">
                PS：添加时请备注<b>技术侦探</b>，谢谢！
              </div></div></div></div> <div class="option-box"><img src="/images/system/heart-1.png" width="25px" class="nozoom"> <span class="show-txt">支持我</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">鼓励/支持/赞赏我</span> <img height="180px" src="/images/personal/encourage-head.png" style="margin:5px;"> <br>1. 不靠它生存但仍希望得到你的鼓励；
                <br>2. 时刻警醒自己保持技术人的初心，沉淀，分享，成长；
              </div></div></div></div> <div title="Retrofit2学习" class="option-box" style="padding-left:2px;text-align:center;"><a href="/java/补充/Retrofit2.html"><img src="/images/system/pre2.png" width="30px" class="nozoom"> <span class="show-txt">上一篇</span></a></div> <div title="枚举" class="option-box" style="padding-left:2px;text-align:center;"><a href="/java/补充/枚举.html"><img src="/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div>  <div class="page-side-sitemap"><div class="option-box"><img src="/images/system/sitemap.png" class="nozoom img"> <span class="show-txt">站点图</span> <div class="sitemap-container"><h4>站点导航图
              <a href="/更新日志/更新日志.html" class="sitemap-top-link"> 更新日志</a></h4> <table class="sitemap-table"><tr><td nowrap="nowrap"><div class="sitemap-col-group">常用搜索</div></td> <td><div class="sitemap-col-item"><a href="http://www.baidu.com/" target="_blank" title="百度">
          百度
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.google.com/" target="_blank" title="Google">
          Google
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.bing.com/" target="_blank" title="Bing">
          Bing
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://github.com" target="_blank" title="Github">
          Github
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.programcreek.com/java-api-examples/index.php" target="_blank" title="搜代码">
          搜代码
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></td> <!----></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">技术社区</div></td> <td><div class="sitemap-col-item"><a href="http://www.csdn.net/" target="_blank" title="CDSN">
          CDSN
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.cnblogs.com/" target="_blank" title="博客园">
          博客园
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.oschina.net" target="_blank" title="OSChina">
          OSChina
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://segmentfault.com/" target="_blank" title="思否">
          思否
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://juejin.im" target="_blank" title="掘金">
          掘金
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.linuxidc.com/" target="_blank" title="Linux公社">
          Linux公社
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.ibm.com/developerworks/cn/" target="_blank" title="IBM 开发者">
          IBM 开发者
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://stackoverflow.com" target="_blank" title="StackOverflow">
          StackOverflow
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></td> <!----></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">Java相关</div></td> <!----> <td><a href="/java/javaSE基础/01_Java入门与开发环境搭建.html" class="sitemap-col-item">
          JavaSE基础
        </a><a href="/java/JavaSE高级/01_IO.html" class="sitemap-col-item">
          JavaSE高级
        </a><a href="/java/javaWeb/01_Web开发基础.html" class="sitemap-col-item">
          JavaWeb
        </a><a href="/java/JUC/1、JUC概述.html" class="sitemap-col-item">
          JUC
        </a><a href="/java/补充/JVM.html" class="sitemap-col-item">
          JVM
        </a><a href="/java/补充/枚举.html" class="sitemap-col-item">
          ENUM
        </a><a href="/java/补充/线程池.html" class="sitemap-col-item">
          线程池
        </a><a href="/java/补充/自定义注解.html" class="sitemap-col-item">
          自定义注解
        </a><a href="/java/响应式编程/前置知识.html" class="sitemap-col-item">
          响应式编程
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">Spring</div></td> <!----> <td><a href="/框架/Mybatis/01_MyBatis快速入门.html" class="sitemap-col-item">
          Mybatis
        </a><a href="/框架/Mybatis/03_MybatisPlus.html" class="sitemap-col-item">
          Mybatis Plus
        </a><a href="/框架/Spring全家桶/Spring/01_SpringIOC和DI.html" class="sitemap-col-item">
          Spring
        </a><a href="/框架/Spring全家桶/SpringMVC/01_SpringMVC快速入门及解析.html" class="sitemap-col-item">
          Spring MVC
        </a><a href="/框架/Spring全家桶/SpringBoot/01_SpringBoot_入门.html" class="sitemap-col-item">
          Spring Boot
        </a><a href="/框架/Spring全家桶/SpringCloudAlibaba/Nacos.html" class="sitemap-col-item">
          Spring Cloud Alibaba
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">中间件&amp;插件</div></td> <!----> <td><a href="/中间件/maven/01_Maven基础.html" class="sitemap-col-item">
          Maven中央仓库
        </a><a href="/中间件/ElasticSearch/ElasticSearch.html" class="sitemap-col-item">
          ElasticSearch
        </a><a href="/中间件/redis/Redis笔记全.html" class="sitemap-col-item">
          Redis
        </a><a href="/中间件/redis/布隆过滤器.html" class="sitemap-col-item">
          布隆过滤器
        </a><a href="/中间件/rocketMq/RocketMQ.html" class="sitemap-col-item">
          RocketMQ.
        </a><a href="/中间件/git/笔记.html" class="sitemap-col-item">
          git
        </a><a href="/中间件/自定义Starter/自定义starter.html" class="sitemap-col-item">
          自定义starter
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">运维</div></td> <!----> <td><a href="/部署/nginx/Nginx.html" class="sitemap-col-item">
          Nginx
        </a><a href="/部署/docker/docker.html" class="sitemap-col-item">
          Docker
        </a><a href="/部署/linux/01_Linux_安装.html" class="sitemap-col-item">
          Linux
        </a><a href="/部署/vm/linux安装centos.html" class="sitemap-col-item">
          VM Ware
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">面向对象</div></td> <!----> <td><a href="/设计模式/创建型模式/" class="sitemap-col-item">
          设计模式
        </a></td></tr></table></div></div></div> <!----> </aside></div><div class="global-ui"><div class="read-more-wrap" style="display:none;position:absolute;bottom:0px;z-index:9999;width:100%;margin-top:-100px;font-family:PingFangSC-Regular, sans-serif;"><div id="read-more-mask" style="position: relative; height: 200px; background: -webkit-gradient(linear, 0 0%, 0 100%, from(rgba(255, 255, 255, 0)), to(rgb(255, 255, 255)));"></div> <a id="read-more-btn" target="_self" style="position: absolute; left: 50%; top: 70%; bottom: 30px;\n        transform: translate(-50%, -50%); width: 160px; height: 36px;\n         line-height: 36px; font-size: 15px; text-align: center;\n          border: 1px solid rgb(222, 104, 109); color: rgb(222, 104, 109);\n           background: rgb(255, 255, 255); cursor: pointer; border-radius: 6px;">阅读全文</a> <div id="btw-modal-wrap" style="display: none;"><div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0);"></div> <div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 300px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;"><span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 34px; font-size: 34px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">×</span> <p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px;">
            微信扫码或搜索：<span style="color: #E9405A; font-weight: bold;">智慧对话的未来</span> <br>发送：<span id="hutec-token" class="token" style="color: #e9415a; font-weight: bold; font-size: 17px; margin-bottom: 45px;">}</span> <br>即可<span style="color: #e9415a; font-weight: bold;">立即永久</span>解锁本站全部文章</p> <img src="/images/personal/qrcode.png" style="width: 180px; margin-top: 10px; margin-bottom: 30px; border: 8px solid rgb(230, 230, 230);"></div></div></div></div></div>
    <script src="/assets/js/cg-styles.js?v=1712123086861" defer></script><script src="/assets/js/cg-4.js?v=1712123086861" defer></script><script src="/assets/js/cg-18.js?v=1712123086861" defer></script><script src="/assets/js/cg-1.js?v=1712123086861" defer></script><script src="/assets/js/cg-79.js?v=1712123086861" defer></script><script src="/assets/js/cg-app.js?v=1712123086861" defer></script>
  </body>
</html>
