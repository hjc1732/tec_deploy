(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{1444:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker入门"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker入门"}},[s._v("#")]),s._v(" Docker入门")]),s._v(" "),a("h2",{attrs:{id:"一-docker介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一-docker介绍"}},[s._v("#")]),s._v(" 一：Docker介绍")]),s._v(" "),a("h3",{attrs:{id:"_1-1-devops存在的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-devops存在的问题"}},[s._v("#")]),s._v(" 1.1：devops存在的问题")]),s._v(" "),a("p",[s._v("1.环境不一致，导致水土不服")]),s._v(" "),a("p",[s._v("开发的时候jdk使用1.8，发版服务器的jdk版本1.7, 比如开发用1.8 配 tomcat 8.5 ，发布用tomcat 10可能会出问题")]),s._v(" "),a("p",[s._v("2.多用户的操作系统相互不能隔离，会相互影响")]),s._v(" "),a("p",[s._v("一台服务器如果部署多个应用程序，当某个程序运行出了问题牵连其他的服务.")]),s._v(" "),a("p",[s._v("多个程序部署在同一个tomcat，默认最大并发150，某个系统超过了呢？其他系统卡")]),s._v(" "),a("p",[s._v("3.当做活动需要快速搭建服务集群时，传统方式效率低")]),s._v(" "),a("p",[s._v("一个大型项目，多个模块实现，打包更换太繁琐")]),s._v(" "),a("p",[s._v("4.安装redis、nginx等服务太繁琐")]),s._v(" "),a("p",[s._v("安装一个Java项目生成环境，jdk,mysql,redis,tomcat，nginx，至少半天时间")]),s._v(" "),a("h3",{attrs:{id:"_1-2-docker-思想"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-docker-思想"}},[s._v("#")]),s._v(" 1.2：docker 思想")]),s._v(" "),a("p",[s._v("1.集装箱   （镜像 ，据此创建容器 ）")]),s._v(" "),a("p",[s._v("将你的应用程序打包成一个集装箱(jdk1.8+项目代码、nginx+gcc+依赖库)，谁需要这个应用直接把整个箱子拿过去即可")]),s._v(" "),a("p",[s._v("2.标准化")]),s._v(" "),a("p",[s._v("运输的标准化、命令的标准化   ，（下载镜像，创建容器的方式标准化）")]),s._v(" "),a("p",[s._v("3.隔离性")]),s._v(" "),a("p",[s._v("docker基于linux内核单独开辟一块空间，来部署运行应用服务")]),s._v(" "),a("h2",{attrs:{id:"二-docker架构与概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二-docker架构与概念"}},[s._v("#")]),s._v(" 二：Docker架构与概念")]),s._v(" "),a("h3",{attrs:{id:"_2-1-架构图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-架构图"}},[s._v("#")]),s._v(" 2.1：架构图")]),s._v(" "),a("p",[a("img",{attrs:{src:t(924),alt:"image-20201121074115001"}})]),s._v(" "),a("h3",{attrs:{id:"_2-2-相关概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-相关概念"}},[s._v("#")]),s._v(" 2.2：相关概念")]),s._v(" "),a("div",{staticClass:"language-txt line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-txt"}},[a("code",[s._v("Docker 包括三个基本概念:\n1.仓库（Repository）：仓库可看成一个代码控制中心，用来保存镜像。\n2.镜像（Image）：Docker 镜像，就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。\n3.容器（Container）：镜像和容器的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("Docker 使用客户端-服务器 (C/S) 架构模式，使用远程API来管理和创建Docker容器。")]),s._v(" "),a("p",[s._v("Docker 容器通过 Docker 镜像来创建。")]),s._v(" "),a("p",[s._v("容器与镜像的关系类似于面向对象编程中的对象与类。")]),s._v(" "),a("h2",{attrs:{id:"三-docker安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三-docker安装"}},[s._v("#")]),s._v(" 三：Docker安装")]),s._v(" "),a("p",[s._v("docker官网：https://www.docker.com/")]),s._v(" "),a("p",[s._v("Docker CE（社区免费版） 的安装请参考官方文档：")]),s._v(" "),a("ul",[a("li",[s._v("MacOS：https://docs.docker.com/docker-for-mac/install/")]),s._v(" "),a("li",[s._v("Windows：https://docs.docker.com/docker-for-windows/install/")]),s._v(" "),a("li",[s._v("Ubuntu：https://docs.docker.com/install/linux/docker-ce/ubuntu/")]),s._v(" "),a("li",[s._v("Debian：https://docs.docker.com/install/linux/docker-ce/debian/")]),s._v(" "),a("li",[s._v("CentOS7：https://docs.docker.com/install/linux/docker-ce/centos/  7以下兼容性差")]),s._v(" "),a("li",[s._v("Fedora：https://docs.docker.com/install/linux/docker-ce/fedora/")]),s._v(" "),a("li",[s._v("其他 Linux 发行版：https://docs.docker.com/install/linux/docker-ce/binaries/")])]),s._v(" "),a("h3",{attrs:{id:"第一步-设置docker的yum源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-设置docker的yum源"}},[s._v("#")]),s._v(" 第一步：设置docker的yum源")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#yum-util 提供yum-config-manager功能")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" yum-utils\nyum-config-manager "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    https://download.docker.com/linux/centos/docker-ce.repo\n    \n    \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(":换行 \n    \n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[a("img",{attrs:{src:t(925),alt:"image-20201121074115001"}})]),s._v(" "),a("h3",{attrs:{id:"第二步-安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-安装docker"}},[s._v("#")]),s._v(" 第二步：安装docker")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载并安装最新版【不建议】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#yum install docker-ce docker-ce-cli containerd.io -y ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载并安装指定版本【建议】")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看docker-ce版本")]),s._v("\nyum list docker-ce "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--showduplicates")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#保证服务器能连接外网")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.09.0 docker-ce-cli-18.09.0 containerd.io "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看docker版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("   \n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动命令")]),s._v("\nsystemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl stop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开机自启动")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("  \t  \n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h3",{attrs:{id:"第三步-docker镜像加速器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-docker镜像加速器"}},[s._v("#")]),s._v(" 第三步：docker镜像加速器")]),s._v(" "),a("blockquote",[a("p",[s._v("安装好Docker之后，我们可以在Docker Hub(https://hub.docker.com/)上下载到大量已经容器化的应用镜像，即拉即用。这些镜像中，有些是Docker官方维护的，更多的是众多开发者自发上传分享的")]),s._v(" "),a("p",[s._v("不幸的是，Docker Hub并没有在国内部署服务器或者使用国内的CDN服务，因此在国内特殊的网络环境下，镜像下载十分耗时，少则二十分钟，多则数十小时。")])]),s._v(" "),a("p",[s._v("配置阿里镜像加速器")]),s._v(" "),a("p",[a("img",{attrs:{src:t(926),alt:"image-20201125100524720"}})]),s._v(" "),a("p",[a("img",{attrs:{src:t(927),alt:"image-20201125100616366"}})]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://evedyeni.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#---------------网易-------------------")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /etc/docker\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["http://hub-mirror.c.163.com"]\n}\nEOF')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"四-docker命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四-docker命令"}},[s._v("#")]),s._v(" 四：Docker命令")]),s._v(" "),a("h3",{attrs:{id:"_4-1-基础命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-基础命令"}},[s._v("#")]),s._v(" 4.1：基础命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_4-2-docker服务相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-docker服务相关命令"}},[s._v("#")]),s._v(" 4.2：docker服务相关命令")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl status "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl stop "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\nsystemctl restart "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开机启动")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_4-3-docker镜像相关命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-docker镜像相关命令"}},[s._v("#")]),s._v(" 4.3：docker镜像相关命令")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("列出本地镜像")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#列出本地所有的docker iamges")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("搜索镜像")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#搜索镜像")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("镜像查找地址：https://hub.docker.com/   需要注册")]),s._v(" "),a("p",[a("img",{attrs:{src:t(928),alt:"image-20201121091800828"}})]),s._v(" "),a("p",[a("img",{attrs:{src:t(929),alt:"image-20201121092057363"}})]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("下载镜像")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载最新（latest）版 ，非必要不建议-")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull 镜像名\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#下载指定版本")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull 镜像名:镜像的版本号     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:5.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ul",[a("li",[a("strong",[s._v("删除镜像")])])]),s._v(" "),a("blockquote",[a("p",[s._v("注意，如果镜像有实例在运行是不能被删除的")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据镜像id删除，注意如果两个镜像的镜像id（id前缀）一样，是无法被删除的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi aa27923130e6\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据镜像名:版本删除   ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi mysql:5.7\n\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("1 查看镜像 docker images")])]),s._v(" "),a("p",[a("strong",[s._v("2 下载镜像 docker pull")])]),s._v(" "),a("p",[a("strong",[s._v("3删除镜像 docker rmi")])]),s._v(" "),a("h3",{attrs:{id:"_4-4-docker容器实例命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-docker容器实例命令"}},[s._v("#")]),s._v(" 4.4：docker容器实例命令")]),s._v(" "),a("p",[a("strong",[s._v("docker run  创建容器    [守护式: -d      交互式: -it]")])]),s._v(" "),a("p",[a("strong",[s._v("docker exec  进入容器")])]),s._v(" "),a("p",[a("strong",[s._v("exit  退出容器")])]),s._v(" "),a("p",[a("strong",[s._v("docker ps 查看正在运行    -a   所有的容器")]),s._v("       all所有")]),s._v(" "),a("p",[a("strong",[s._v("docker start 容器名")])]),s._v(" "),a("p",[a("strong",[s._v("docker stop")])]),s._v(" "),a("p",[a("strong",[s._v("docker rm")])]),s._v(" "),a("h4",{attrs:{id:"创建容器实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建容器实例"}},[s._v("#")]),s._v(" 创建容器实例")]),s._v(" "),a("ul",[a("li",[s._v("命令：\ndocker run [OPTIONS] IMAGE [COMMAND][ARG…]")]),s._v(" "),a("li",[s._v("OPTIONS说明：\n"),a("strong",[s._v("–-name=‘容器新名字’：为容器自定义一个名称")]),s._v(" "),a("strong",[s._v("-d：后台运行容器，并返回容器ID，也即启动守护式容器")]),s._v(" "),a("strong",[s._v("-i：以交互模式运行容器")]),s._v(" "),a("strong",[s._v("-t：(terminal)为容器重新分配一个伪终端")]),s._v("\n-P：随机端口映射\n-p：指定映射端口，有以下四种格式\n①ip:hostPort:containerPort\n②ip::containerPort\n③hostPort:containerPort\n④containerPort")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据mysql镜像创建mysql容器实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zhuxm01 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name mysql01 \\        #交互式用-it 代替 -d -d：代表守护式")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3307")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:5.7\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入到容器：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mysql01 /bin/bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#或用交互式创建")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql05 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3308")]),s._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root mysql:5.7 /bin/bash\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#切换到容器的根目录")]),s._v("\nroot@09eb509b5fd4:/data"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看容器的跟目录")]),s._v("\nroot@09eb509b5fd4:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("   dev                         entrypoint.sh  home  lib64  mnt  proc  run   srv  tmp  var\nboot  docker-entrypoint-initdb.d  etc            lib   media  opt  root  sbin  sys  usr\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果是-it形式的，退出交互窗口，注意一旦exit，那么容器实例也随之关闭")]),s._v("\nroot@09eb509b5fd4:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@zhuxm01 ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h4",{attrs:{id:"列出正在运行的容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#列出正在运行的容器"}},[s._v("#")]),s._v(" 列出正在运行的容器")]),s._v(" "),a("ul",[a("li",[s._v("命令：\ndocker ps [OPTIONS]")]),s._v(" "),a("li",[s._v("OPTIONS说明：\n-a :列出当前所有正在运行的容器+历史上运行过的\n-l :显示最近创建的容器。\n-n：显示最近n个创建的容器。\n-q :静默模式，只显示容器编号。\n–no-trunc :不截断输出。")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看正在运行的")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看正在运行以及创建了但是并没有运行的容器实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h4",{attrs:{id:"关闭容器实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭容器实例"}},[s._v("#")]),s._v(" 关闭容器实例")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#其中redis02是容器的名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop mysql01   \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"启动容器实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动容器实例"}},[s._v("#")]),s._v(" 启动容器实例")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#其中redis-c2是容器的名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start mysql01\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"删除容器实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除容器实例"}},[s._v("#")]),s._v(" 删除容器实例")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#其中redis-c2是容器的名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" mysql01\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"查看容器实例的信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看容器实例的信息"}},[s._v("#")]),s._v(" 查看容器实例的信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect mysql01\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"五-docker数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#五-docker数据卷"}},[s._v("#")]),s._v(" 五：Docker数据卷")]),s._v(" "),a("h3",{attrs:{id:"_5-0-数据卷概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-0-数据卷概念"}},[s._v("#")]),s._v(" 5.0：数据卷概念")]),s._v(" "),a("p",[s._v("思考：")]),s._v(" "),a("p",[s._v("容器数据持久化，即容器如果被删除，那么容器的数据是否会被删除？如果数据删除了怎么办？")]),s._v(" "),a("p",[s._v("数据卷")]),s._v(" "),a("p",[s._v("1.数据卷就是宿主机   (虚拟机)的一个目录或者文件")]),s._v(" "),a("p",[s._v("2.当容器目录与宿主机目录绑定后可以双向影响")]),s._v(" "),a("p",[s._v("3.一个数据卷可以被多个容器绑定（挂载）")]),s._v(" "),a("p",[s._v("4.一个容器可以绑定多个数据卷")]),s._v(" "),a("p",[s._v("5**.当容器被删除，数据卷不会被删除**")]),s._v(" "),a("p",[a("img",{attrs:{src:t(930),alt:"image-20201125112312930"}})]),s._v(" "),a("h3",{attrs:{id:"_5-1-创建数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-创建数据卷"}},[s._v("#")]),s._v(" 5.1：创建数据卷")]),s._v(" "),a("p",[s._v("创建tomcat容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search tomcat\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull tomcat:9.0\n\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -- rm表示当容器被停止时会自动删除该容器  ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat01 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("    \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("          centos 端口     docker容器 端口\ntomcat:9.0\n    \n                \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建数据卷的命令,tomcat为数据卷的名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume create tomcat    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据卷本质就是宿主机的一个目录 ，的默认存放路径为")]),s._v("\n/var/lib/docker/volumes/\n\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume inspect tomcat\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" tomcat\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据卷绑定容器目录，以下面这种方式绑定，如果/usr/local/tomcat/目录下有内容，会将这些内容同步到数据卷中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat01 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":8080 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" tomcat:/usr/local/tomcat/  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ntomcat:9.0\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改宿主目录，查看容器目录")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改容器目录，查看宿主目录")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除容器，查看数据卷，数据卷不会被删除")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("创建mysql的数据卷：")]),s._v(" "),a("p",[s._v("docker run -d --name mysql01 -p3307:3306 -e MYSQL_ROOT_PASSWORD=root -v mysql:/var/lib/mysql  mysql:5.7")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-txt line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-txt"}},[a("code",[s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"六-docker应用服务部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六-docker应用服务部署"}},[s._v("#")]),s._v(" 六：docker应用服务部署")]),s._v(" "),a("h3",{attrs:{id:"_6-1-docker安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-docker安装mysql"}},[s._v("#")]),s._v(" 6.1:docker安装mysql")]),s._v(" "),a("p",[s._v("第一步：搜索mysql镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("第二步：下载mysql镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:5.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("第三步：创建mysql容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" mysql02 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p3306:3306")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nmysql:5.7\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("第四步：远程连接mysql")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#进入容器内部")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" mysql01 /bin/bash       退出用exit\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#连接容器内的mysql   如：mysql -uroot -proot  ")]),s._v("\ngrant all privileges  on *.* to root@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"七-dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#七-dockerfile"}},[s._v("#")]),s._v(" 七：DockerFile")]),s._v(" "),a("p",[s._v("我们自己想做自己的镜像，这么做？")]),s._v(" "),a("p",[s._v("我们可以做微服务的镜像")]),s._v(" "),a("h3",{attrs:{id:"_7-1-dockerfile简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-dockerfile简介"}},[s._v("#")]),s._v(" 7.1：dockerfile简介")]),s._v(" "),a("p",[s._v("1.DockerFile是一个文本文件")]),s._v(" "),a("p",[s._v("2.DockerFile文件中包含了一条条的指令")]),s._v(" "),a("p",[s._v("3.DockerFile可以帮我们构建一个自己的全新镜像")]),s._v(" "),a("p",[s._v("通过dockerfile为团队提供一个完全一致的环境，解决了因环境不同导致的水土不服的问题")]),s._v(" "),a("h3",{attrs:{id:"_7-2-dockerfile指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-dockerfile指令"}},[s._v("#")]),s._v(" 7.2：dockerfile指令")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("关键字")]),s._v(" "),a("th",[s._v("作用")]),s._v(" "),a("th",[s._v("备注")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("FROM")]),s._v(" "),a("td",[s._v("指定父镜像")]),s._v(" "),a("td",[s._v("指定dockerfile基于那个image构建")])]),s._v(" "),a("tr",[a("td",[s._v("MAINTAINER")]),s._v(" "),a("td",[s._v("作者信息")]),s._v(" "),a("td",[s._v("用来标明这个dockerfile谁写的")])]),s._v(" "),a("tr",[a("td",[s._v("LABEL")]),s._v(" "),a("td",[s._v("标签")]),s._v(" "),a("td",[s._v("用来标明dockerfile的标签 可以使用Label代替Maintainer 最终都是在docker image基本信息中可以查看")])]),s._v(" "),a("tr",[a("td",[s._v("RUN")]),s._v(" "),a("td",[s._v("执行命令")]),s._v(" "),a("td",[s._v('执行一段命令 默认是/bin/sh 格式: RUN command 或者 RUN ["command" , "param1","param2"]')])]),s._v(" "),a("tr",[a("td",[s._v("CMD")]),s._v(" "),a("td",[s._v("容器启动命令")]),s._v(" "),a("td",[s._v('提供启动容器时候的默认命令 和ENTRYPOINT配合使用.格式 CMD command param1 param2 或者 CMD ["command" , "param1","param2"]')])]),s._v(" "),a("tr",[a("td",[s._v("ENTRYPOINT")]),s._v(" "),a("td",[s._v("入口")]),s._v(" "),a("td",[s._v("一般在制作一些执行就关闭的容器中会使用")])]),s._v(" "),a("tr",[a("td",[s._v("COPY")]),s._v(" "),a("td",[s._v("复制文件")]),s._v(" "),a("td",[s._v("build的时候复制文件到image中")])]),s._v(" "),a("tr",[a("td",[s._v("ADD")]),s._v(" "),a("td",[s._v("添加文件")]),s._v(" "),a("td",[s._v("build的时候添加文件到image中 不仅仅局限于当前build上下文 可以来源于远程服务")])]),s._v(" "),a("tr",[a("td",[s._v("ENV")]),s._v(" "),a("td",[s._v("环境变量")]),s._v(" "),a("td",[s._v("指定build时候的环境变量 可以在启动的容器的时候 通过-e覆盖 格式ENV name=value")])]),s._v(" "),a("tr",[a("td",[s._v("ARG")]),s._v(" "),a("td",[s._v("构建参数")]),s._v(" "),a("td",[s._v("构建参数 只在构建的时候使用的参数 如果有ENV 那么ENV的相同名字的值始终覆盖arg的参数")])]),s._v(" "),a("tr",[a("td",[s._v("VOLUME")]),s._v(" "),a("td",[s._v("定义外部可以挂载的数据卷")]),s._v(" "),a("td",[s._v('指定build的image那些目录可以启动的时候挂载到文件系统中 启动容器的时候使用 -v 绑定 格式 VOLUME ["目录"]')])]),s._v(" "),a("tr",[a("td",[s._v("EXPOSE")]),s._v(" "),a("td",[s._v("暴露端口")]),s._v(" "),a("td",[s._v("定义容器运行的时候监听的端口 启动容器的使用-p来绑定暴露端口 格式: EXPOSE 8080 或者 EXPOSE 8080/udp")])]),s._v(" "),a("tr",[a("td",[s._v("WORKDIR")]),s._v(" "),a("td",[s._v("工作目录")]),s._v(" "),a("td",[s._v("指定容器内部的工作目录 如果没有创建则自动创建 如果指定/ 使用的是绝对地址 如果不是/开头那么是在上一条workdir的路径的相对路径")])]),s._v(" "),a("tr",[a("td",[s._v("USER")]),s._v(" "),a("td",[s._v("指定执行用户")]),s._v(" "),a("td",[s._v("指定build或者启动的时候 用户 在RUN CMD ENTRYPONT执行的时候的用户")])]),s._v(" "),a("tr",[a("td",[s._v("HEALTHCHECK")]),s._v(" "),a("td",[s._v("健康检查")]),s._v(" "),a("td",[s._v("指定监测当前容器的健康监测的命令 基本上没用 因为很多时候 应用本身有健康监测机制")])]),s._v(" "),a("tr",[a("td",[s._v("ONBUILD")]),s._v(" "),a("td",[s._v("触发器")]),s._v(" "),a("td",[s._v("当存在ONBUILD关键字的镜像作为基础镜像的时候 当执行FROM完成之后 会执行 ONBUILD的命令 但是不影响当前镜像 用处也不怎么大")])]),s._v(" "),a("tr",[a("td",[s._v("STOPSIGNAL")]),s._v(" "),a("td",[s._v("发送信号量到宿主机")]),s._v(" "),a("td",[s._v("该STOPSIGNAL指令设置将发送到容器的系统调用信号以退出。")])]),s._v(" "),a("tr",[a("td",[s._v("SHELL")]),s._v(" "),a("td",[s._v("指定执行脚本的shell")]),s._v(" "),a("td",[s._v("指定RUN CMD ENTRYPOINT 执行命令的时候 使用的shell")])])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("FROM 指定当前自定义镜像需要依赖的镜像\nRUN 执行linux命令，比如cd mkdir等\nWORKDIR：声明镜像的默认工作目录，当容器启动后自动跳到该目录\nADD 将宿主机的jar包加入到自定义的镜像的目录中\nCMD：需要执行的命令，在workdir目录下执行这条命令,容器启动（在workdir目录）执行该命令\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_7-3-部署springboot微服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-部署springboot微服务"}},[s._v("#")]),s._v(" 7.3：部署Springboot微服务")]),s._v(" "),a("p",[s._v("需求：")]),s._v(" "),a("p",[s._v("定义dockerfile，发布springboot项目")]),s._v(" "),a("p",[s._v("第一步：编写dockerfile")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#定义基础镜像")]),s._v("\nfrom java:8\nmaintainer sujie "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("823601183")]),s._v("@qq.com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#创建目录")]),s._v("\nrun "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /jars\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#指定工作目录")]),s._v("\nworkdir /jars\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#把宿主机的jar包放入容器目录(/jars)中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v("  hospital-0.0.1-SNAPSHOT.jar app.jar\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#容器启动后，启动服务")]),s._v("\ncmd "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-jar")]),s._v(" app.jar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("传到 export/server下")]),s._v(" "),a("p",[s._v("第二步：构建镜像")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" dockerfile.txt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" app:1.0 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("    空格和.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("docker images 本地镜像可以看到")]),s._v(" "),a("p",[s._v("第三步：启动容器")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" app01 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8881")]),s._v(":9999 app:1.0 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("常用命令总结：")]),s._v(" "),a("p",[a("strong",[s._v("镜像：")])]),s._v(" "),a("p",[s._v("​\t"),a("strong",[s._v("1 查看镜像 docker images")])]),s._v(" "),a("p",[s._v("**2 下载镜像 docker pull  **")]),s._v(" "),a("p",[a("strong",[s._v("3删除镜像 docker rmi")])]),s._v(" "),a("p",[a("strong",[s._v("容器：")])]),s._v(" "),a("p",[a("strong",[s._v("docker run  创建容器    [守护式: -d      交互式: -it]")])]),s._v(" "),a("p",[a("strong",[s._v("docker exec  进入容器")])]),s._v(" "),a("p",[a("strong",[s._v("exit  退出容器")])]),s._v(" "),a("p",[a("strong",[s._v("docker ps 查看正在运行    -a:所有的容器")])]),s._v(" "),a("p",[a("strong",[s._v("docker start 容器名")])]),s._v(" "),a("p",[a("strong",[s._v("docker stop")])]),s._v(" "),a("p",[s._v("**docker rm     **")]),s._v(" "),a("p",[s._v("数据卷：")]),s._v(" "),a("p",[s._v("docker volume create      ( 数据备份)")]),s._v(" "),a("p",[s._v("docker volume rm")]),s._v(" "),a("p",[s._v("docker volume ls")]),s._v(" "),a("p",[a("strong",[s._v("构建镜像：")])]),s._v(" "),a("p",[a("strong",[s._v("docker build")])])])}),[],!1,null,null,null);a.default=n.exports},924:function(s,a,t){s.exports=t.p+"assets/img/576507-docker1.0a0c1b59.png"},925:function(s,a,t){s.exports=t.p+"assets/img/image-20201121074115001.6b7e7fef.png"},926:function(s,a,t){s.exports=t.p+"assets/img/image-20201125100524720.0e4554fa.png"},927:function(s,a,t){s.exports=t.p+"assets/img/image-20201125100616366.08669a64.png"},928:function(s,a,t){s.exports=t.p+"assets/img/image-20201121091800828.e03b6975.png"},929:function(s,a,t){s.exports=t.p+"assets/img/image-20201121092057363.6eba9909.png"},930:function(s,a,t){s.exports=t.p+"assets/img/image-20201125112312930.cfeaf70e.png"}}]);