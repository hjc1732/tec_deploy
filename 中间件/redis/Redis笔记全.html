<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis | 技术侦探</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/favicon.ico">
    <script charset="utf-8" async="async" src="/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/js/fingerprint2.min.js"></script>
    <script charset="utf-8" async="async" src="https://s9.cnzz.com/z_stat.php?id=1278232949&amp;web_id=1278232949"></script>
    <script>
              var _hmt = _hmt || [];
              (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?0b31b4c146bf7126aed5009e1a4a11c8";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
              })();
            </script>
    <meta name="description" content="技术并不是我们所追求的目的,而是技术创新世界">
    <meta property="article:modified_time" content="null">
    <meta property="og:title" content="Redis">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html">
    <meta name="twitter:title" content="Redis">
    <meta name="twitter:url" content="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="robots" content="all">
    <meta name="author" content="小傅哥">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="keywords" content="Java基础">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.ee4e0787.css" as="style"><link rel="preload" href="/assets/css/styles.css?v=1719459192901" as="style"><link rel="preload" href="/assets/js/cg-styles.js?v=1719459192901" as="script"><link rel="preload" href="/assets/js/cg-app.js?v=1719459192901" as="script"><link rel="preload" href="/assets/js/cg-4.js?v=1719459192901" as="script"><link rel="preload" href="/assets/js/cg-22.js?v=1719459192901" as="script"><link rel="preload" href="/assets/js/cg-1.js?v=1719459192901" as="script"><link rel="preload" href="/assets/js/cg-88.js?v=1719459192901" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.ee4e0787.css"><link rel="stylesheet" href="/assets/css/styles.css?v=1719459192901">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">技术侦探</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/javaSE基础/01_Java入门与开发环境搭建.html" class="nav-link">
  javaSE
</a></li><li class="dropdown-subitem"><a href="/java/javaWeb/01_Web开发基础.html" class="nav-link">
  javaWeb
</a></li><li class="dropdown-subitem"><a href="/java/JUC/1、JUC概述.html" class="nav-link">
  JUC
</a></li><li class="dropdown-subitem"><a href="/java/响应式编程/前置知识.html" class="nav-link">
  响应式编程
</a></li><li class="dropdown-subitem"><a href="/设计模式/概述/概述.html" class="nav-link">
  设计模式
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/jdbc/01_JDBC.html" class="nav-link">
  jdbc
</a></li><li class="dropdown-subitem"><a href="/db/mysql/Mysql基础/01_MySQL概述.html" class="nav-link">
  mysql
</a></li></ul></li><li class="dropdown-item"><h4>
          补充
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/补充/Retrofit2.html" class="nav-link">
  Retrofit2
</a></li><li class="dropdown-subitem"><a href="/java/补充/rxJava/rxJava.html" class="nav-link">
  rxJava
</a></li><li class="dropdown-subitem"><a href="/java/补充/lua.html" class="nav-link">
  lua
</a></li><li class="dropdown-subitem"><a href="/java/补充/JVM.html" class="nav-link">
  jvm
</a></li><li class="dropdown-subitem"><a href="/java/补充/枚举.html" class="nav-link">
  枚举
</a></li><li class="dropdown-subitem"><a href="/java/补充/线程池.html" class="nav-link">
  线程池
</a></li><li class="dropdown-subitem"><a href="/java/补充/自定义注解.html" class="nav-link">
  自定义注解
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端/前端基础/01_HTML.html" class="nav-link">
  前端基础
</a></li><li class="dropdown-subitem"><a href="/前端/vue/01_ECMAScript6入门.html" class="nav-link">
  vue
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/DDD架构/01-ddd是什么.html" class="nav-link">
  DDD
</a></li><li class="dropdown-item"><!----> <a href="/框架/Mybatis/01_MyBatis快速入门.html" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><h4>
          Spring全家桶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Spring全家桶/Spring/01_SpringIOC和DI.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringMVC/01_SpringMVC快速入门及解析.html" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringBoot/01_SpringBoot_入门.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringSecurity/SpringSecurity.html" class="nav-link">
  SpringSecurity
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringCloudAlibaba/Nacos.html" class="nav-link">
  SpringCloudAlibaba
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/中间件/ElasticSearch/ElasticSearch.html" class="nav-link">
  中间件 | 自研轮子
</a></div><div class="nav-item"><a href="/部署/linux/01_Linux_安装.html" class="nav-link">
  部署|运维
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><span class="title">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/实战/商城/项目笔记.html" class="nav-link">
  锋迷铺子
</a></li><li class="dropdown-item"><!----> <a href="/实战/实用工具类/DocUtils.html" class="nav-link">
  实用工具类
</a></li><li class="dropdown-item"><!----> <a href="http://520.hjcwzx.top/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  研究生工作平台
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/更新日志/更新日志.html" class="nav-link">
  更新日志
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          java
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/javaSE基础/01_Java入门与开发环境搭建.html" class="nav-link">
  javaSE
</a></li><li class="dropdown-subitem"><a href="/java/javaWeb/01_Web开发基础.html" class="nav-link">
  javaWeb
</a></li><li class="dropdown-subitem"><a href="/java/JUC/1、JUC概述.html" class="nav-link">
  JUC
</a></li><li class="dropdown-subitem"><a href="/java/响应式编程/前置知识.html" class="nav-link">
  响应式编程
</a></li><li class="dropdown-subitem"><a href="/设计模式/概述/概述.html" class="nav-link">
  设计模式
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/jdbc/01_JDBC.html" class="nav-link">
  jdbc
</a></li><li class="dropdown-subitem"><a href="/db/mysql/Mysql基础/01_MySQL概述.html" class="nav-link">
  mysql
</a></li></ul></li><li class="dropdown-item"><h4>
          补充
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/补充/Retrofit2.html" class="nav-link">
  Retrofit2
</a></li><li class="dropdown-subitem"><a href="/java/补充/rxJava/rxJava.html" class="nav-link">
  rxJava
</a></li><li class="dropdown-subitem"><a href="/java/补充/lua.html" class="nav-link">
  lua
</a></li><li class="dropdown-subitem"><a href="/java/补充/JVM.html" class="nav-link">
  jvm
</a></li><li class="dropdown-subitem"><a href="/java/补充/枚举.html" class="nav-link">
  枚举
</a></li><li class="dropdown-subitem"><a href="/java/补充/线程池.html" class="nav-link">
  线程池
</a></li><li class="dropdown-subitem"><a href="/java/补充/自定义注解.html" class="nav-link">
  自定义注解
</a></li></ul></li><li class="dropdown-item"><h4>
          前端
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/前端/前端基础/01_HTML.html" class="nav-link">
  前端基础
</a></li><li class="dropdown-subitem"><a href="/前端/vue/01_ECMAScript6入门.html" class="nav-link">
  vue
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/框架/DDD架构/01-ddd是什么.html" class="nav-link">
  DDD
</a></li><li class="dropdown-item"><!----> <a href="/框架/Mybatis/01_MyBatis快速入门.html" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><h4>
          Spring全家桶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/框架/Spring全家桶/Spring/01_SpringIOC和DI.html" class="nav-link">
  Spring
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringMVC/01_SpringMVC快速入门及解析.html" class="nav-link">
  SpringMVC
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringBoot/01_SpringBoot_入门.html" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringSecurity/SpringSecurity.html" class="nav-link">
  SpringSecurity
</a></li><li class="dropdown-subitem"><a href="/框架/Spring全家桶/SpringCloudAlibaba/Nacos.html" class="nav-link">
  SpringCloudAlibaba
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/中间件/ElasticSearch/ElasticSearch.html" class="nav-link">
  中间件 | 自研轮子
</a></div><div class="nav-item"><a href="/部署/linux/01_Linux_安装.html" class="nav-link">
  部署|运维
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="实战" class="dropdown-title"><span class="title">实战</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/实战/商城/项目笔记.html" class="nav-link">
  锋迷铺子
</a></li><li class="dropdown-item"><!----> <a href="/实战/实用工具类/DocUtils.html" class="nav-link">
  实用工具类
</a></li><li class="dropdown-item"><!----> <a href="http://520.hjcwzx.top/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  研究生工作平台
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/更新日志/更新日志.html" class="nav-link">
  更新日志
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>中间件</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/中间件/ElasticSearch/ElasticSearch.html" class="sidebar-link">Elasticsearch</a></li><li><a href="/中间件/EasyES/Easy-es.html" class="sidebar-link">Easy-Es</a></li><li><a href="/中间件/ELK/使用docker搭建ELK.html" class="sidebar-link">ELK搭建(Docker版本)</a></li><li><a href="/中间件/redis/Redis笔记全.html" class="active sidebar-link">Redis</a></li><li><a href="/中间件/redis/布隆过滤器.html" class="sidebar-link">布隆过滤器</a></li><li><a href="/中间件/rocketMq/RocketMQ.html" class="sidebar-link">RocketMQ入门</a></li><li><a href="/中间件/rocketMq/rocketMq深入.html" class="sidebar-link">RocketMQ深入理解</a></li><li><a href="/中间件/git/笔记.html" class="sidebar-link">Git</a></li><li><a href="/中间件/maven/01_Maven基础.html" class="sidebar-link">Maven基础</a></li><li><a href="/中间件/maven/02_Maven聚合工程.html" class="sidebar-link">Maven聚合工程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>自定义starter</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/中间件/自定义Starter/自定义starter.html" class="sidebar-link">自定义starter</a></li><li><a href="/中间件/自定义Starter/白名单过滤starter.html" class="sidebar-link">白名单过滤</a></li><li><a href="/中间件/自定义Starter/上传中央仓库.html" class="sidebar-link">上传maven中央仓库</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ApacheRocketMQ开发者指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/中间件/rocketMq/mq/mq.html" class="sidebar-link">ApacheRocketMQ开发者指南</a></li><li><a href="/中间件/rocketMq/mq/concept.html" class="sidebar-link">基本概念</a></li><li><a href="/中间件/rocketMq/mq/features.html" class="sidebar-link">特性(features)</a></li><li><a href="/中间件/rocketMq/mq/architecture.html" class="sidebar-link">架构设计</a></li><li><a href="/中间件/rocketMq/mq/design.html" class="sidebar-link">设计(design)</a></li><li><a href="/中间件/rocketMq/mq/RocketMQ_Example.html" class="sidebar-link">样例</a></li><li><a href="/中间件/rocketMq/mq/best_practice.html" class="sidebar-link">最佳实践</a></li><li><a href="/中间件/rocketMq/mq/msg_trace/user_guide.html" class="sidebar-link">消息轨迹</a></li><li><a href="/中间件/rocketMq/mq/acl/user_guide.html" class="sidebar-link">权限控制</a></li><li><a href="/中间件/rocketMq/mq/dledger/quick_start.html" class="sidebar-link">Dledger快速搭建</a></li><li><a href="/中间件/rocketMq/mq/dledger/deploy_guide.html" class="sidebar-link">Dledger集群搭建</a></li><li><a href="/中间件/rocketMq/mq/operation.html" class="sidebar-link">运维管理</a></li></ul></section></li></ul> </aside> <div><main class="page"> <div class="theme-default-content content__default"><h1 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h1> <h1 id="一-redis前提"><a href="#一-redis前提" class="header-anchor">#</a> 一：Redis前提</h1> <p>缓存数据库/缓存</p> <p>List Map Set :本地缓存</p> <p>Redis：缓存数据库</p> <p>在Java中使用非常频繁的缓存数据库</p> <h1 id="二-redis简介"><a href="#二-redis简介" class="header-anchor">#</a> 二：Redis简介</h1> <h2 id="_2-1-redis简介"><a href="#_2-1-redis简介" class="header-anchor">#</a> 2.1：Redis简介</h2> <p>官网：https://redis.io/</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache, and message broker. Redis provides data structures such as strings, hashes, lists, sets, sorted sets with range queries, bitmaps, hyperloglogs, geospatial indexes, and streams. Redis has built-in replication, Lua scripting, LRU eviction, transactions, and different levels of on-disk persistence, and provides high availability via Redis Sentinel and automatic partitioning with Redis Cluster
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>Redis 是完全开源的，C语言编写，<strong>基于内存，是一个高性能的 Nosql（非关系型） 数据库</strong>。</p></blockquote> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>一.关系型数据库（mysql、oracle、PostgreSQL、SqlServer）
定义：关系型数据库最典型的数据结构是表，由二维表及其之间的联系所组成的一个数据组织.
【优点：】
1.易于维护：都是使用表结构，格式一致；
2.使用方便：SQL语言通用，可用于复杂查询，可用于一个表及多个表之间非常复杂关联查询；
【缺点：】
1.关系型数据库操作的是磁盘，硬盘I/O是一个很大的瓶颈
2.固定的表结构，灵活度稍欠；


稀疏型
{name:'jack'}
{course:'java'}
{name:'jack,sex:'1'}

二.非关系型数据库（Redis(KV)、Memcache（KV）、ElasticSearch(JSON)）
定义：非关系型数据库是一种数据结构化存储方法的集合，可以是文档或者键值对。
【优点：】
1.格式灵活：存储数据的格式可以是key,value形式、文档形式。
2.速度快：nosql可以使用内存存储，而关系型数据库只能使用硬盘；
【缺点：】
不支持sql，数据间没有关联关系
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_2-2-redis特性"><a href="#_2-2-redis特性" class="header-anchor">#</a> 2.2：Redis特性</h2> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>1、性能极高 – Redis 读的速度是110000次/s,写的速度是81000次/s 。
2、丰富的数据类型 – Redis支持五种常用数据类型：string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)
3、原子 – Redis的所有操作都是原子性的，意思就是要么成功执行要么失败完全不执行。单个操作是原子性的。多个操作也支持事务 
4、丰富的特性 – Redis还支持 publish/subscribe, 通知, key 过期等等特性。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-txt line-numbers-mode"><pre class="language-txt"><code>Redis 与其他 key - value（Memcache） 缓存产品有以下三个特点：
1：Redis支持数据的持久化，可以将内存中的数据保存在磁盘中，重启的时候可以再次加载进行使用。
2：Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储。
3：Redis支持数据的备份，即master-slave模式的数据备份。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="_2-3-redis-使用场景"><a href="#_2-3-redis-使用场景" class="header-anchor">#</a> 2.3：Redis:使用场景</h2> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>1：查询缓存       mybatis 的一二级缓存    list map set    
2：分布式锁 setnx   
3：秒杀活动数据存储(将Redis当做database来存储商品信息以及用户的下单信息)
4：注册、登录 使用Redis存储验证码（Redis的key可以设置过期时间）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h1 id="三-redis安装"><a href="#三-redis安装" class="header-anchor">#</a> 三：Redis安装</h1> <h2 id="window安装redis"><a href="#window安装redis" class="header-anchor">#</a> Window安装Redis</h2> <blockquote><p>下载地址：https://github.com/microsoftarchive/redis/releases</p></blockquote> <p><img src="/assets/img/image-20200928150936812.68064543.png" alt="image-20200928150936812"></p> <p><img src="/assets/img/image-20200928151038244.1a2e58af.png" alt="image-20200928151038244"></p> <p>闪退：路径下cmd ，redis-server.exe redis.windows.conf</p> <h2 id="docker安装redis"><a href="#docker安装redis" class="header-anchor">#</a> docker安装Redis</h2> <p>第一步：搜索redis镜像     先去 hub.docker.com</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> search redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第二步：下载redis镜像</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull redis:6.0.9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第三步：创建redis容器</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> redis01 <span class="token parameter variable">-p6379:6379</span>  redis:6.0.9   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第四步：远程连接redis</p> <h2 id="linux安装redis"><a href="#linux安装redis" class="header-anchor">#</a> Linux安装Redis</h2> <blockquote><p>redis-6.0.8.tar.gz           gcc    c语言的编译器</p> <p>注意：redis6版本要求gcc版本必须5.3以上，centos7默认安装的版本是4.8.5，查看gcc版本命令 gcc-v</p></blockquote> <p>升级gcc,以下每行命令依次执行即可升级gcc到9.3.1</p> <div class="language-she line-numbers-mode"><pre class="language-text"><code>yum -y install centos-release-scl
yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils
scl enable devtoolset-9 bash
echo &quot;source /opt/rh/devtoolset-9/enable&quot; &gt;&gt;/etc/profile　   　--使永久生效
yum install tcl -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上传redis的压缩包到服务器,并解压</p> <p>（如果之前安装过，server下有redis*，先到server下，执行rm -rf ./redis* *  ）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@zhuxm01 soft<span class="token punctuation">]</span><span class="token comment"># tar -zxvf redis-6.0.8.tar.gz  -C /usr/local/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>编译（ 在redis的解压路径执行以下命令)</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@zhuxm01 redis-6.0.8<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/redis-6.0.8/</span>
<span class="token punctuation">[</span>root@zhuxm01 redis-6.0.8<span class="token punctuation">]</span><span class="token comment"># make</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@zhuxm01 redis-6.0.8<span class="token punctuation">]</span><span class="token comment"># cd /usr/local/redis-6.0.8/</span>
<span class="token punctuation">[</span>root@zhuxm01 redis-6.0.8<span class="token punctuation">]</span><span class="token comment"># make PREFIX=/usr/local/redis install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/image-20200928152525279.b6495a95.png" alt="image-20200928152525279"></p> <p>前台启动(先切换到 /usr/local/redis/bin，在执行./redis-server)</p> <p><img src="/assets/img/image-20200928152611117.644ebb71.png" alt="image-20200928152611117"></p> <h1 id="四-redis数据类型-列举数据类型"><a href="#四-redis数据类型-列举数据类型" class="header-anchor">#</a> 四：Redis数据类型   (列举数据类型)</h1> <p><strong>面试：Redis常用的数据类型</strong></p> <blockquote><p><strong>String, List ,Set,Hash ,ZSet</strong></p> <p>K  string</p> <p>V   String</p></blockquote> <h2 id="_4-1-string"><a href="#_4-1-string" class="header-anchor">#</a> 4.1：String</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">set</span> k <span class="token function">v</span>
get k
del k
strlen k
<span class="token comment">#自加、自减</span>
incr age
incrby age <span class="token number">3</span>
decr age
decrby age

<span class="token comment">#value字符串操作</span>
getrange name <span class="token number">0</span> <span class="token parameter variable">-1</span> <span class="token comment">#取整个字符串</span>
getrange name <span class="token number">0</span>  <span class="token number">1</span>
setrange name <span class="token number">0</span> x

<span class="token comment"># SETEX 是一个原子性(atomic)操作，设置值和设置生存时间两个动作会在同一时间内完成</span>
SETEX pro <span class="token number">10</span> 华为    （查看剩余时间ttl pro）   
<span class="token builtin class-name">set</span> pro 华为
expire pro <span class="token number">10</span>


<span class="token comment">#在分布式系统里面可以使用如下命令实现分布式锁  (synchronized)</span>
setnx<span class="token punctuation">(</span>set <span class="token keyword">if</span> not exist<span class="token punctuation">)</span>
setnx name a 
如果返回1：设置成功
如果返回0：设置失败
       redis分布式锁 setIfAbsent<span class="token punctuation">(</span><span class="token punctuation">)</span>     
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h2 id="_4-2-list"><a href="#_4-2-list" class="header-anchor">#</a> 4.2：List</h2> <blockquote><p>K  string</p> <p>V   List</p> <p>list特点：有序、可重复</p> <p>git push</p> <p>vue2  代码 push</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>存
lpush num <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span>
rpush num2 <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span>
查
lrange num <span class="token number">0</span> <span class="token parameter variable">-1</span>     查所有
lrange num2 <span class="token number">0</span> <span class="token parameter variable">-1</span>
<span class="token comment">#根据下标获取元素</span>
lindex num index

弹出（获取数据的同时将数据从list中删除）
lpop
rpop

大小
llen num


<span class="token comment">#队列:先进先出</span>
lpush num3 <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span>  <span class="token comment">#左边推进去</span>
rpop num3 <span class="token number">1</span>       <span class="token comment">#右边取出来</span>
或者
rpush num4 <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span>
lpop num4


<span class="token comment">#栈:先进后出</span>
lpush num5 <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span>
lpop num5
或者
rpush num6 <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span>
rpop num6

lpush  rpop / rpush lpop  队列
lpush lpop / rpush rpop   栈 

<span class="token comment">#list的长度</span>
llen num5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><p>lindex num index</p> <h2 id="_4-3-set"><a href="#_4-3-set" class="header-anchor">#</a> 4.3：Set</h2> <blockquote><p>K  string</p> <p>V   Set</p> <p>set特点：无序，不可重复</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>存
sadd ips <span class="token string">'192.168.22.1'</span> <span class="token string">'192.168.22.2'</span> <span class="token string">'192.168.22.2'</span>
查
smembers ips
sismember ips member  （返回1存在，0 不存在）

删
srem ips <span class="token string">'192.168.22.1'</span>
大小
scard ips <span class="token comment">#获取set的长度</span>



sadd nums <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">0</span> <span class="token number">9</span> <span class="token number">8</span> <span class="token number">9</span> <span class="token number">0</span> <span class="token number">8</span> <span class="token number">6</span> 
<span class="token comment">#随机</span>
srandmember nums <span class="token number">3</span>
<span class="token comment">#随机并移除</span>
spop nums <span class="token number">3</span>


交集
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD myset <span class="token string">&quot;hello&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD myset <span class="token string">&quot;foo&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD myset <span class="token string">&quot;bar&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD myset2 <span class="token string">&quot;hello&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SADD myset2 <span class="token string">&quot;world&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis <span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> SINTER myset myset2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;hello&quot;</span>

并集
redis<span class="token operator">&gt;</span> SADD key1 <span class="token string">&quot;a&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis<span class="token operator">&gt;</span> SADD key1 <span class="token string">&quot;b&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis<span class="token operator">&gt;</span> SADD key1 <span class="token string">&quot;c&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis<span class="token operator">&gt;</span> SADD key2 <span class="token string">&quot;c&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis<span class="token operator">&gt;</span> SADD key2 <span class="token string">&quot;d&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis<span class="token operator">&gt;</span> SADD key2 <span class="token string">&quot;e&quot;</span>
<span class="token punctuation">(</span>integer<span class="token punctuation">)</span> <span class="token number">1</span>
redis<span class="token operator">&gt;</span> SUNION key1 key2
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;a&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;c&quot;</span>
<span class="token number">3</span><span class="token punctuation">)</span> <span class="token string">&quot;b&quot;</span>
<span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">&quot;e&quot;</span>
<span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">&quot;d&quot;</span>
 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h2 id="_4-4-hash"><a href="#_4-4-hash" class="header-anchor">#</a> 4.4：Hash</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>&gt;    KEY VALUE   (key value    )
&gt;
&gt; ​     Redis 购物车：         KEY : &quot;shopcart&quot;   field:userid   value :List&lt;Goods&gt;--&gt;string
&gt;
&gt; ​         1 频率使用高
&gt;
&gt; ​          2购物车意向购买，未必真正去支付，下订单的话可以把订单数据放到数据库中
&gt;
&gt; ​                                                                          没有下订单，用redis存商品信息
&gt;
&gt; 秒杀 Redis   ：快 
&gt;
&gt; 
&gt;
&gt; 
&gt;
&gt; K  string
&gt;
&gt; V   Hash                                                                           
&gt;
&gt; hash特点：hash的key不能重复，如果重复就覆盖          &lt;key,&lt;key,value&gt;&gt;
&gt;
&gt; ​                                                                                            
&gt;
&gt; ​                                                                                                                

```shell
存
hset person name 'jack'      dicts    1     件
hset person age 40            dicts   2     套
取
hget person name
hget person age
存多个
hmset person name 'rose' age 12
大小
hlen person
判断k是否存在
hexists person age

hkeys person
hvals person

#hash可以大大减少redis中的K  同时hash结构特别适合存放对象
person :
        name   'jack'
        age     '18' 
hget  person age
购物车的例子:每个人-&gt;每个商品的信息     redis 中  (hash)

   uid, goodid, count~price~sum
   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><h2 id="_4-5-zset-sorted-set"><a href="#_4-5-zset-sorted-set" class="header-anchor">#</a> 4.5：Zset(sorted set)</h2> <blockquote><p>K  string</p> <p>V   ZSet</p> <p>zset特点：有序，不可重复，通过score来进行排序，score必须是数字</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>通过score进行排序
zadd hot <span class="token number">300</span> <span class="token string">'华为met10'</span> <span class="token number">10</span> <span class="token string">'苹果10'</span>  <span class="token number">19</span> <span class="token string">'小米'</span>
zrange hot <span class="token number">0</span> <span class="token parameter variable">-1</span>   升序
zrevrange hot <span class="token number">0</span> <span class="token parameter variable">-1</span>  降序

<span class="token comment">#分数范围过滤</span>
zrangebyscore hot <span class="token number">11</span> <span class="token number">100</span>
zrangebyscore hot <span class="token number">10</span> <span class="token number">100</span> limit <span class="token number">0</span> <span class="token number">1</span>

<span class="token comment">#删除</span>
zrem hot <span class="token string">'小米'</span>
zcard hot <span class="token comment">#查看集合的元素个数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>1)数据量不要太大</p> <p>2)数据比较稳定，变化不大</p> <p>3)访问频繁</p> <p>redis  / String Hash</p> <h1 id="五-其他指令"><a href="#五-其他指令" class="header-anchor">#</a> 五：其他指令</h1> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#########################key相关指令##############</span>
keys parttern
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> keys art*
<span class="token number">1</span><span class="token punctuation">)</span> <span class="token string">&quot;article2&quot;</span>
<span class="token number">2</span><span class="token punctuation">)</span> <span class="token string">&quot;artile1&quot;</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> 

<span class="token comment">#如果存在返回1，否则返回0</span>
exists key


del key

keys * 查看所有key

<span class="token comment">#给key设置过期时间    </span>
expire key seconds       
<span class="token comment">#查看key的剩余时间  -1：表示没有过期时间  &gt;0 表示剩余的时间 -2:过期，数据被回收</span>
ttl key
<span class="token comment">#不设置过期时间，让它常驻内存</span>
persist key   



<span class="token comment">################db相关的指令##########################</span>

Redis有16个db  分别为0，1,<span class="token punctuation">..</span>.,15【redis的默认数据库为0】
<span class="token comment">#切换数据库</span>
<span class="token keyword">select</span> index
<span class="token comment">#清空数据库</span>
flushdb
<span class="token comment">#清空所有的数据库</span>
flushall
<span class="token comment">#数据库的数据总条数</span>
dbsize 

<span class="token comment">#最近一次保存数据的时间戳  </span>
lastsave

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h1 id="六-redis事务"><a href="#六-redis事务" class="header-anchor">#</a> 六：Redis事务</h1> <blockquote><p>Redis中的事务跟mysql不一样，mysql可以保证acid 但是redis的事务在运行时异常不能保证原子性，只能在编译时异常保证原子性</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>mutli <span class="token comment">#开启事务          begin transation       </span>
<span class="token builtin class-name">exec</span>   <span class="token comment">#提交事务         commit</span>
discard <span class="token comment">#回滚事务         rollback     </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#正常事务提交</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi 
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name jack
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get name
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> age <span class="token number">18</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
<span class="token comment">#redis事务保证顺序执行、同时一起执行</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#放弃事务</span>

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name sdf
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> age <span class="token number">12</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> discard

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#编译时异常,回滚</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi 
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name <span class="token number">123</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> kset xx sdf
ERR unknown <span class="token builtin class-name">command</span> <span class="token variable"><span class="token variable">`</span>kset<span class="token variable">`</span></span>, with args beginning with: <span class="token variable"><span class="token variable">`</span>xx<span class="token variable">`</span></span>, <span class="token variable"><span class="token variable">`</span>sdf<span class="token variable">`</span></span>, 

<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> age <span class="token number">21</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
EXECABORT Transaction discarded because of previous errors.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#运行时异常，不回滚</span>
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> multi
OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> name jack
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> incr name
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">set</span> age <span class="token number">12</span>
QUEUED
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> <span class="token builtin class-name">exec</span>
OK
ERR value is not an integer or out of range

OK
<span class="token number">127.0</span>.0.1:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get age
<span class="token number">12</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h1 id="七-jedis"><a href="#七-jedis" class="header-anchor">#</a> 七：Jedis</h1> <h2 id="pom依赖"><a href="#pom依赖" class="header-anchor">#</a> pom依赖</h2> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>redis.clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jedis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="java代码"><a href="#java代码" class="header-anchor">#</a> java代码</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> testRedis <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.234.122&quot;</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

 <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> testJedispwd <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jedis</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.234.131&quot;</span><span class="token punctuation">,</span><span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;jack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>//最大连接和空闲连接设置一样的</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>
<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testJedisPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">JedisPoolConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPoolConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//最大空闲连接数, 默认8个（可用的最大连接）</span>
        config<span class="token punctuation">.</span><span class="token function">setMaxIdle</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//最大连接数, 默认8个 (理论上的最大连接)</span>
        config<span class="token punctuation">.</span><span class="token function">setMaxTotal</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      

        <span class="token class-name">JedisPool</span> jedisPool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPool</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span><span class="token string">&quot;192.168.234.122&quot;</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> jedisPool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jedisPool<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>查看防火墙状态：systemctl status firewalld</strong></p> <p><strong>关闭防火墙：systemctl stop firewalld</strong></p> <p>查看redis是否启动： <strong>ps -ef | grep redis</strong></p> <p><strong>查看tcp端口：netstat -nltp   | grep 6379</strong>        //--（ 全局搜索带redis的find /  -name  redis*）</p> <p><strong>强制关闭 pkill -9 redis</strong></p> <p><strong>客户端连上  shutdown</strong> <strong>、或者是服务端 ctrl +c</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>注意：

<span class="token number">1</span>：修改bind

<span class="token builtin class-name">bind</span> ip错误理解：不是说bind哪个ip ，就只能哪个ip来访问redis

<span class="token builtin class-name">bind</span> ip正确理解： bind本机的网卡对应的ip地址，只有通过指定网卡进来的主机才能访问redis

<span class="token builtin class-name">bind</span> <span class="token number">127.0</span>.0.1（默认），本地回环地址。那么访问redis服务只能通过本机的客户端连接，而无法通过远程连接

<span class="token builtin class-name">bind</span> <span class="token number">192.168</span>.88.100  通过本机ens33网卡进来的主机都可以访问redis，这样设置后基本所有的主机都可以访问

如果要限制只允许某些host访问，那么可以通过配置安全组实现



</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>jedis常见api</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>字符串
<span class="token comment">// 1.string</span>
<span class="token comment">//输出结果: OK</span>
jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果: world</span>
jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果:1</span>
jedis<span class="token punctuation">.</span><span class="token function">incr</span><span class="token punctuation">(</span><span class="token string">&quot;counter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
哈希
<span class="token comment">// 2.hash</span>
jedis<span class="token punctuation">.</span><span class="token function">hset</span><span class="token punctuation">(</span><span class="token string">&quot;myhash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;v1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">hset</span><span class="token punctuation">(</span><span class="token string">&quot;myhash&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;f2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;v2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果 : {f1=v1, f2=v2}</span>
jedis<span class="token punctuation">.</span><span class="token function">hgetAll</span><span class="token punctuation">(</span><span class="token string">&quot;myhash&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
列表
<span class="token comment">// 3.list</span>
jedis<span class="token punctuation">.</span><span class="token function">rpush</span><span class="token punctuation">(</span><span class="token string">&quot;mylist&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">rpush</span><span class="token punctuation">(</span><span class="token string">&quot;mylist&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">rpush</span><span class="token punctuation">(</span><span class="token string">&quot; mylist&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果 : [1, 2, 3]</span>
jedis<span class="token punctuation">.</span><span class="token function">lrange</span><span class="token punctuation">(</span><span class="token string">&quot;mylist&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
集合
<span class="token comment">// 4.set</span>
jedis<span class="token punctuation">.</span><span class="token function">sadd</span><span class="token punctuation">(</span><span class="token string">&quot; myset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">sadd</span><span class="token punctuation">(</span><span class="token string">&quot; myset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">sadd</span><span class="token punctuation">(</span><span class="token string">&quot; myset&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果 : [b, a]</span>
jedis<span class="token punctuation">.</span><span class="token function">smembers</span><span class="token punctuation">(</span><span class="token string">&quot;myset&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
有序集合
<span class="token comment">// 5.zset</span>
jedis<span class="token punctuation">.</span><span class="token function">zadd</span><span class="token punctuation">(</span><span class="token string">&quot;myzset&quot;</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token string">&quot;tom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">zadd</span><span class="token punctuation">(</span><span class="token string">&quot;myzset&quot;</span><span class="token punctuation">,</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token string">&quot;peter&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jedis<span class="token punctuation">.</span><span class="token function">zadd</span><span class="token punctuation">(</span><span class="token string">&quot;myzset&quot;</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token string">&quot;james&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//输出结果 : [[[&quot;james&quot;],33.0], [[&quot;peter&quot;],66.0], [[&quot;tom&quot;],99.0]]</span>
jedis<span class="token punctuation">.</span><span class="token function">zrangeWithScores</span><span class="token punctuation">(</span><span class="token string">&quot;myzset&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h1 id="八-spring-data-redis"><a href="#八-spring-data-redis" class="header-anchor">#</a> 八：Spring-data-redis</h1> <blockquote><p>官网：https://spring.io/projects/spring-data-redis</p></blockquote> <h2 id="_8-1-基于springboot-重点"><a href="#_8-1-基于springboot-重点" class="header-anchor">#</a> 8.1：基于springboot    (重点)</h2> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/&gt;</span></span> <span class="token comment">&lt;!-- lookup parent from repository --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.commons/commons-pool2 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-pool2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment">#redis的连接信息</span>
<span class="token key attr-name">spring</span><span class="token punctuation">:</span>
<span class="token key attr-name">  redis</span><span class="token punctuation">:</span>
<span class="token key attr-name">    host</span><span class="token punctuation">:</span> <span class="token value attr-value">192.168.234.110</span>
<span class="token key attr-name">    port</span><span class="token punctuation">:</span> <span class="token value attr-value">6379</span>
<span class="token key attr-name">    password</span><span class="token punctuation">:</span> <span class="token value attr-value">123456</span>
<span class="token comment">#redis连接池的配置信息</span>
<span class="token key attr-name">    lettuce</span><span class="token punctuation">:</span>
<span class="token key attr-name">      pool</span><span class="token punctuation">:</span>
<span class="token key attr-name">        max-active</span><span class="token punctuation">:</span> <span class="token value attr-value">8</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>测试</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>qf</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ContextConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringJUnit4ClassRunner</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Set</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * &lt;p&gt;title: com.qf&lt;/p&gt;
 * &lt;p&gt;Company: wendao&lt;/p&gt;
 * author zhuximing
 * date 2021/6/24
 * description:
 */</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;classpath:app-redis.xml&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisTest</span> <span class="token punctuation">{</span>


    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>
    
    
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> name <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    
    
    
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//存</span>
        <span class="token class-name">BoundListOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> operations <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundListOps</span><span class="token punctuation">(</span><span class="token string">&quot;names&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">rightPush</span><span class="token punctuation">(</span><span class="token string">&quot;张飞&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">rightPush</span><span class="token punctuation">(</span><span class="token string">&quot;关羽&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//取</span>

        <span class="token class-name">String</span> s <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">rightPop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BoundHashOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> operations <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundHashOps</span><span class="token punctuation">(</span><span class="token string">&quot;person&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//存</span>
        operations<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;18&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//取</span>
        <span class="token class-name">Object</span> name <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//取所有的value</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> values <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        values<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BoundSetOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> operations <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundSetOps</span><span class="token punctuation">(</span><span class="token string">&quot;ips&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//存</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;110&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;110&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;111&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;112&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//取</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> members <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">members</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        members<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//判断元素是否存在</span>
        <span class="token class-name">Boolean</span> member <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">isMember</span><span class="token punctuation">(</span><span class="token string">&quot;110&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testZset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BoundZSetOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> operations <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundZSetOps</span><span class="token punctuation">(</span><span class="token string">&quot;pro&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//存</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;华为&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;小米&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        operations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;iphone&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//取</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> range <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        range<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> strings <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">reverseRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        strings<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">//显示分数信息</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ZSetOperations<span class="token punctuation">.</span>TypedTuple</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> typedTuples <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">rangeWithScores</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ZSetOperations<span class="token punctuation">.</span>TypedTuple</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> typedTuple <span class="token operator">:</span> typedTuples<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> value <span class="token operator">=</span> typedTuple<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Double</span> score <span class="token operator">=</span> typedTuple<span class="token punctuation">.</span><span class="token function">getScore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>score<span class="token operator">+</span><span class="token string">&quot; --&quot;</span><span class="token operator">+</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    
    
 
    
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">test6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">SessionCallback</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> callback <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SessionCallback</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">RedisOperations</span> operations<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">DataAccessException</span>      <span class="token punctuation">{</span>            
                <span class="token comment">//开启事务</span>
                operations<span class="token punctuation">.</span><span class="token function">multi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span><span class="token punctuation">{</span>
                    <span class="token class-name">BoundValueOperations</span> name <span class="token operator">=</span> operations<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    name<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                   <span class="token comment">// int i=1/0;</span>
                    <span class="token comment">//事务提交</span>
                    <span class="token keyword">return</span> operations<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
                     <span class="token comment">//事务回滚</span>
                      operations<span class="token punctuation">.</span><span class="token function">discard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                      <span class="token keyword">return</span>  <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br></div></div><h1 id="九-redis应用"><a href="#九-redis应用" class="header-anchor">#</a> 九：Redis应用</h1> <p><strong>短信验证码</strong></p> <p><strong>缓存</strong></p> <p><strong>Redis分布式锁 (setIfAbsent())</strong></p> <h2 id="_9-1-短信验证码"><a href="#_9-1-短信验证码" class="header-anchor">#</a> 9.1：短信验证码</h2> <blockquote><p>用Redis存放短信验证码</p> <p>why not session？</p></blockquote> <p>Session依赖于Cookie</p> <p>hutool工具包：</p> <p>糊涂工具官网：https://www.hutool.cn/docs/#/</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.7.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>模拟：1生成随机生成4个数字，key为手机号,数字为val值，放在redis 中，设置超时时间2分钟</p> <p>​            2 做一个简易的页面，输入手机号，验证码，后台比对输入的验证和redis中的存储数据</p> <p>​            3 一样登录，不一样登录失败</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hutoo工具包使用：
&lt;dependency&gt;
    &lt;groupId&gt;cn.hutool&lt;/groupId&gt;
    &lt;artifactId&gt;hutool-all&lt;/artifactId&gt;
    &lt;version&gt;5.7.19&lt;/version&gt;
&lt;/dependency&gt;
如需使用thymeleaf，则可以引入： 
    &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;
      &lt;/dependency&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">LoginService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//1 产生验证码</span>
        <span class="token class-name">String</span> code <span class="token operator">=</span> <span class="token class-name">RandomUtil</span><span class="token punctuation">.</span><span class="token function">randomNumbers</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//2 放到redis ，设置一下超时2分钟   &lt;KEY,&lt;key,value&gt;   &quot;phonecode&quot;,&quot;13112341234&quot;,&quot;5467&quot;</span>
        <span class="token class-name">BoundValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> mycode <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;13112341234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mycode<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mycode<span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">checkCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> phone<span class="token punctuation">,</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BoundValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> phonecode <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> codeRedis <span class="token operator">=</span> phonecode<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span><span class="token punctuation">(</span>codeRedis<span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> codeRedis<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
             <span class="token keyword">return</span> <span class="token string">&quot;校验通过&quot;</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token string">&quot;校验失败&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_9-2-redis查询缓存"><a href="#_9-2-redis查询缓存" class="header-anchor">#</a> 9.2：Redis查询缓存</h2> <p>查询缓存： 数据字典表</p> <p>电商项目</p> <p>金额单位：元    /   万元</p> <p>衣服数量量级：件 /套</p> <p>鞋子: 只/双</p> <p>以字典表为例： 1先从redis缓存中查询是否有所有字典表数据</p> <p>​                            2 如果有，直接返回到前端，不到数据库中查</p> <p>​                            3 如果没有，查询db，返回到前端，并放到redis中</p> <p><img src="data:image/png;base64,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" alt="image-20221109054626874"></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllDicts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BoundValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisCache <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;dicts1234&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//缓存中有数据</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> dicts1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            redisCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>dicts1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> dicts1<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment">//没有，查db，放到redis中</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from redis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s <span class="token operator">=</span> redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//hutool中的方法转化</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> lists <span class="token operator">=</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token class-name">Dict</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> lists<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h1 id="_10-redis持久化-重点"><a href="#_10-redis持久化-重点" class="header-anchor">#</a> 10：Redis持久化    (重点)</h1> <p><strong>面试题：redis 持久化方式RDB和AOF</strong></p> <p><strong>RDB默认开启，不能保证数据不丢失</strong></p> <p><strong>AOF默认不开启，能保证数据不丢失</strong></p> <p><strong>mybatis缓存：一级缓存,会话级别，默认开启</strong></p> <p>​                         <strong>二级缓存，工厂级别，默认关闭</strong></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>为什么要持久化
Redis是基于内存存储数据的，如果Redis服务器宕机，数据就丢失了

持久化：将内存中的数据不定期备份到磁盘中

数据恢复：将磁盘中的数据 加载（恢复）到内存中

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-txt line-numbers-mode"><pre class="language-txt"><code>Redis持久化方案2种
RDB(Redis Databases):内存中的数据集快照写入磁盘，也就是 Snapshot 快照,恢复时是将快照文件直接读到内存里。
AOF(Append Of File):以日志的形式记录每个写操作，当redis重启时，加载aof文件，将修改命令执行一遍。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_10-1-rdb"><a href="#_10-1-rdb" class="header-anchor">#</a> 10.1：RDB</h2> <h3 id="rdb持久化方案的特点"><a href="#rdb持久化方案的特点" class="header-anchor">#</a> RDB持久化方案的特点</h3> <blockquote><p>Redis会单独fork一个子进程进行持久化工作，该子进程先将数据写入一个临时文件，等待持久化完毕，再将临时文件覆盖替换上此持久化好的文件，整个过程主进程是不会进行任何的IO操作，确保了极高的性能，而且当进行大规模数据恢复的时候RDB性能也非常高.
<strong>但是RDB有缺点，没法保证数据不丢失</strong></p> <p>Redis默认的持久化方案就是rdb</p></blockquote> <p><img src="/assets/img/image-20210110183002483-1610290031516.f1e85976.png" alt="image-20210110183002483"></p> <h3 id="rdb相关配置"><a href="#rdb相关配置" class="header-anchor">#</a> rdb相关配置</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#可以通过该配置修改文件名</span>
dbfilename dump.rdb 
<span class="token comment">#指定rdb文件存储的路劲</span>
<span class="token function">dir</span>    /user/local/redis/data/

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="触发方式"><a href="#触发方式" class="header-anchor">#</a> 触发方式</h3> <p>自动触发（满足条件）可配置</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>#配置rdb数据持久化自动触发的条件
save 900 1
save 300 10
save 60 10000     #rdb默认开启无法关闭
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>手动触发：</p> <ul><li>1.正常关闭redis-server（shutdown，flushdb手动）</li> <li>2.save该命令会阻塞当前Redis服务器，执行save命令期间，Redis不能处理其他命令，直到RDB过程完成为止。
　　显然该命令对于内存比较大的实例会造成长时间阻塞，这是致命的缺陷。</li> <li>3.bgsave<br>
执行该命令时，Redis会在后台异步进行快照操作，快照同时还可以响应客户端请求。具体操作是Redis进程执行fork操作创建子进程，RDB持久化过程由子进程负责，完成后自动结束。阻塞只发生在fork阶段，一般时间很短。</li></ul> <p><img src="/assets/img/image-20210110182705846.103fd58c.png" alt="image-20210110182705846"></p> <h2 id="_10-2-aof"><a href="#_10-2-aof" class="header-anchor">#</a> 10.2：AOF</h2> <h3 id="aof持久化方案的特点"><a href="#aof持久化方案的特点" class="header-anchor">#</a> AOF持久化方案的特点</h3> <blockquote><p>将Redis所有的写操作<strong>命令</strong>记录下来（读操作不记录），以文件追加的方式存放起来，当Redis重启恢复数据时，将操作日志从头到尾执行一遍，恢复数据</p> <p>aof默认是关闭的，如果要开启aof必须要配置</p> <p>appendonly yes</p></blockquote> <p><img src="/assets/img/image-20210110184533162.93f2aed3.png" alt="image-20210110184533162"></p> <h3 id="aof相关配置"><a href="#aof相关配置" class="header-anchor">#</a> AOF相关配置</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#AOF持久化方案默认是关闭，如果要开启，需要如下配置</span>
appendonly <span class="token function">yes</span>
<span class="token comment">#自定义aof日志文件名</span>
appendfilename <span class="token string">&quot;appendonly.aof&quot;</span> 
<span class="token comment">#指定aof文件存储目录</span>
<span class="token function">dir</span> 

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="触发方式-2"><a href="#触发方式-2" class="header-anchor">#</a> 触发方式</h3> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>#aof的触发条件
appendfsync always
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="/assets/img/image-20210110184852778.b9bff00b.png" alt="image-20210110184852778"></p> <h3 id="aof重写"><a href="#aof重写" class="header-anchor">#</a> AOF重写</h3> <blockquote><p>由于AOF持久化是Redis不断将写命令记录到 AOF 文件中，随着Redis不断的进行，AOF 的文件会越来越大，文件越大，占用服务器内存越大以及 AOF 恢复要求时间越长。为了解决这个问题，Redis新增了重写机制，当AOF文件的大小超过所设定的阈值时，Redis就会启动AOF文件的内容压缩，只保留可以恢复数据的最小指令集。可以使用命令 bgrewriteaof 来重新。</p></blockquote> <p><img src="/assets/img/image-20210110185044480.d7edd1b5.png" alt="image-20210110185044480"></p> <h2 id="_10-3-rdb对比aof"><a href="#_10-3-rdb对比aof" class="header-anchor">#</a> 10.3：RDB对比AOF</h2> <p><img src="/assets/img/image-20210110185248622.8992bc16.png" alt="image-20210110185248622"></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>建议:
如果对数据的安全性要求比较高（Redis存储秒杀的订单数据）  必须要开启aof   
如果对数据的安全性要求不高（Redis查询缓存） ，可以不开启aof


秒杀： redis分布式锁  定时任务 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h1 id="_11-redis集群-伪集群"><a href="#_11-redis集群-伪集群" class="header-anchor">#</a> 11：Redis集群   (伪集群)</h1> <p>关闭防火墙  systemctl stop firewalld</p> <p>不随机启动 systemctl disable firewalld</p> <h2 id="集群配置"><a href="#集群配置" class="header-anchor">#</a> 集群配置</h2> <p>1：复制配置文件: cp redis.conf  /usr/local/redis/conf/redis.conf</p> <p>2:  复制出三份 redis7001.conf / redis7002.conf / redis7003.conf</p> <p>3 :情况文件内容 可以打开后用： 10000dd</p> <p><strong>主节点配置</strong></p> <p>7001节点配置 :redis7001.conf</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>include /usr/local/redis/conf/redis.conf
port 7001
pidfile /var/run/redis7001.pid
dbfilename redis7001.rdb
appendfilename &quot;appendonly7001.aof&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>7002从节点配置 :redis7002.conf</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>include /usr/local/redis/conf/redis.conf
port 7002
pidfile /var/run/redis7002.pid
dbfilename redis7002.rdb
appendfilename &quot;appendonly7002.aof&quot;
slaveof 192.168.88.100 7001
# masterauth 123456
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>7003从节点配置 :redis7003.conf</p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>include /usr/local/redis/conf/redis.conf
port 7003
pidfile /var/run/redis7003.pid
dbfilename redis7003.rdb
appendfilename &quot;appendonly7003.aof&quot;
slaveof 192.168.88.100 7001
#masterauth 123456
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>启动集群</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># ./redis-server ../conf/redis7001.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># ./redis-server ../conf/redis7002.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># ./redis-server ../conf/redis7003.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># ps -ef|grep redis</span>

连接的话用：./redis-cli <span class="token parameter variable">-p</span> <span class="token number">7001</span>  ./redis-cli <span class="token parameter variable">-p</span> <span class="token number">7002</span>  ./redis-cli <span class="token parameter variable">-p</span> <span class="token number">7003</span>
root      <span class="token number">13195</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">10</span>:49 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7001
root      <span class="token number">13204</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">10</span>:49 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7002
root      <span class="token number">13213</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">10</span>:49 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7003

先连接再 查看节点状态：info replication
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h1 id="_12-哨兵模式sentinel"><a href="#_12-哨兵模式sentinel" class="header-anchor">#</a> 12：哨兵模式sentinel</h1> <p>关联图：Redis集群.bmp</p> <h2 id="哨兵模式介绍"><a href="#哨兵模式介绍" class="header-anchor">#</a> 哨兵模式介绍</h2> <p><img src="/assets/img/image-20210110223536409.5c4cb758.png" alt="image-20210110223536409"></p> <div class="language-txt line-numbers-mode"><pre class="language-txt"><code>哨兵职责：
监控(Monitoring)：Sentinel 会不断地定期检查你的主服务器和从服务器是否运作正常。

提醒(Notification): 当被监控的某个 Redis 服务器出现问题时， Sentinel 可以通过 API 向管理员或者其他应用程序发送通知。

自动故障迁移(Automaticfailover): 当主服务器不能正常工作时， Sentinel 会开始一次自动故障迁移操作，选举新主

哨兵：是整个集群的入口 ，程序连的时候连的是哨兵
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="哨兵模式配置"><a href="#哨兵模式配置" class="header-anchor">#</a> 哨兵模式配置</h2> <p>在redis下创建文件夹sentinel-conf</p> <p>1：先启动redis集群</p> <p>2：三个哨兵就新建3个分别sentinel01.conf 、sentinel02.conf、sentinel03.conf，注意区分端口</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0
<span class="token comment">#哨兵的端口</span>
port <span class="token number">26379</span>
<span class="token comment">#mymaster自定义</span>
sentinel monitor mymaster <span class="token number">192.168</span>.44.100 <span class="token number">7001</span> <span class="token number">1</span>          <span class="token comment">#一个哨兵认为挂掉就挂掉</span>
<span class="token comment">#设置redis主节点的访问密码</span>
<span class="token comment">#sentinel auth-pass mymaster 123456</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-txt line-numbers-mode"><pre class="language-txt"><code>bind 0.0.0.0
#哨兵的端口
port 26380
#mymaster自定义
sentinel monitor mymaster 192.168.88.100 7001 1
#设置redis主节点的访问密码
#sentinel auth-pass mymaster 123456
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-txt line-numbers-mode"><pre class="language-txt"><code>bind 0.0.0.0
#哨兵的端口
port 26381
#mymaster自定义
sentinel monitor mymaster 192.168.88.100 7001 1
#设置redis主节点的访问密码
#sentinel auth-pass mymaster 123456
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>3：启动哨兵,先进入到redis/bin下，./redis-sentinel  ../sentinel-conf/sentinel01.conf</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>redis-sentinel sentinel01.conf
redis-sentinel sentinel02.conf
redis-sentinel sentinel03.conf

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>4：哨兵详细配置项 ，#可以不配</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 哨兵sentinel实例运行的端口 默认26379</span>
port <span class="token number">26379</span>

<span class="token comment">#以守护进程模式启动</span>
daemonize <span class="token function">yes</span>

<span class="token comment"># 哨兵sentinel的工作目录</span>
<span class="token function">dir</span> /tmp

<span class="token comment">#日志文件名</span>
logfile <span class="token string">&quot;sentinel_26379.log&quot;</span>

<span class="token comment"># sentinel监控的master主机</span>
sentinel monitor mymaster <span class="token number">192.168</span>.1.108 <span class="token number">6379</span> <span class="token number">2</span>

<span class="token comment"># sentinel连接主从密码验证，注意必须为主从设置一样的密码</span>
<span class="token comment"># sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span>
sentinel auth-pass mymaster <span class="token number">1234</span>

<span class="token comment"># 指定多少毫秒之后 主节点没有应答哨兵sentinel 此时 哨兵主观上认为主节点下线 默认30秒</span>
sentinel down-after-milliseconds mymaster <span class="token number">5000</span>


<span class="token comment">#在发生failover主备切换时，这个选项指定了最多可以有多少个slave同时对新的master进行同步数据。这个数字越小，完成failover所需的时间就越长，但是如果这个数字越大，就意味着越多的slave因为replication而不可用。可以设为 1 来保证每次只有一个slave处于不能处理命令请求的状态</span>
sentinel parallel-syncs mymaster <span class="token number">1</span>

<span class="token comment"># 失效转移最大时间设置</span>
sentinel failover-timeout mymaster <span class="token number">180000</span>

<span class="token comment">#如果设置了这个脚本路径，那么必须保证这个脚本存在于这个路径，并且是可执行的，否则sentinel无法正常启动成功。</span>

sentinel notification-script mymaster /var/redis/notify.sh  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><img src="/assets/img/image-20210111143629643.151e2137.png" alt="image-20210111143629643"></p> <h3 id="基于springboot"><a href="#基于springboot" class="header-anchor">#</a> 基于springboot</h3> <p>永久关闭防护墙:systemctl disable firewalld.service</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">master</span><span class="token punctuation">:</span> mymaster
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> 192.168.88.100<span class="token punctuation">:</span><span class="token number">26379</span>
        <span class="token punctuation">-</span> 192.168.88.100<span class="token punctuation">:</span><span class="token number">26380</span>
        <span class="token punctuation">-</span> 192.168.88.100<span class="token punctuation">:</span><span class="token number">26381</span>
  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>qf</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">StringRedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">ContextConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringJUnit4ClassRunner</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * &lt;p&gt;title: com.qf&lt;/p&gt;
 * &lt;p&gt;Company: wendao&lt;/p&gt;
 * author zhuximing
 * date 2021/6/25
 * description:
 */</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringJUnit4ClassRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ContextConfiguration</span><span class="token punctuation">(</span>locations <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;classpath:app-sentinel.xml&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestSentinel</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> redisTemplate<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span>  <span class="token function">testSentinel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

        redisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;rose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> name <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h1 id="_13-redis分布式集群"><a href="#_13-redis分布式集群" class="header-anchor">#</a> 13：Redis分布式集群</h1> <p>关联图：Redis分布式集群.bmp</p> <h2 id="分布式集群架构"><a href="#分布式集群架构" class="header-anchor">#</a> 分布式集群架构</h2> <blockquote><p>sentinel弊端：内存的瓶颈</p></blockquote> <h2 id="分布式集群搭建"><a href="#分布式集群搭建" class="header-anchor">#</a> 分布式集群搭建</h2> <blockquote><p>说明:</p> <p>1：伪集群，一台服务器，启动6个redis服务、通过端口区分（7001~7006）</p> <p>2：真集群：6个节点或者3个节点</p></blockquote> <p>先强杀所有redis进程，把redis/data下的所有数据文件清空 rm -rf ./ *</p> <p>redis下建 cluster-conf目录</p> <p>第一步：从源码包复制redis.conf到指定目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@zhuxm01 server<span class="token punctuation">]</span><span class="token comment"># cp redis-6.0.8/redis.conf/export/server/redis/cluster-conf/</span>
创建6个文件redis7001-7006
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>第二步：分别配置每个redis的配置文件，详细配置如下，注意区分端口</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>include /usr/local/redis/cluster-conf/redis.conf
port <span class="token number">7001</span>
<span class="token comment">#redis的进程文件</span>
pidfile /var/run/redis7001.pid
<span class="token comment">#rdb文件名</span>
dbfilename redis7001.rdb
<span class="token comment">#aof文件名</span>
appendfilename <span class="token string">&quot;appendonly7001.aof&quot;</span>
<span class="token comment"># 集群</span>
cluster-enabled <span class="token function">yes</span>
<span class="token comment"># 生成的node文件</span>
cluster-config-file nodes7001.conf
<span class="token comment">#守护进程</span>
daemonize <span class="token function">yes</span>
<span class="token comment">#aof、rdb文件存储目录</span>
<span class="token function">dir</span> /usr/local/redis/data/
<span class="token builtin class-name">bind</span> <span class="token number">0.0</span>.0.0

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-she line-numbers-mode"><pre class="language-text"><code>#如果redis设置密码，加上如下配置
requirepass &quot;123456&quot;
masterauth &quot;123456&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/image-20201009095058410.96b3a78f.png" alt="image-20201009095058410"></p> <p>第三步：启动每个redis服务</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># redis-server /usr/local/redis/redis7001.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># redis-server /usr/local/redis/redis7002.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># redis-server /usr/local/redis/redis7003.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># redis-server /usr/local/redis/redis7004.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># redis-server /usr/local/redis/redis7005.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># redis-server /usr/local/redis/redis7006.conf </span>
<span class="token punctuation">[</span>root@root bin<span class="token punctuation">]</span><span class="token comment"># ps -ef|grep redis</span>
root      <span class="token number">11186</span>      <span class="token number">1</span>  <span class="token number">0</span> 09:51 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7001 <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span>
root      <span class="token number">11195</span>      <span class="token number">1</span>  <span class="token number">0</span> 09:51 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7002 <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span>
root      <span class="token number">11203</span>      <span class="token number">1</span>  <span class="token number">0</span> 09:51 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7003 <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span>
root      <span class="token number">11212</span>      <span class="token number">1</span>  <span class="token number">0</span> 09:51 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7004 <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span>
root      <span class="token number">11220</span>      <span class="token number">1</span>  <span class="token number">0</span> 09:51 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7005 <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span>
root      <span class="token number">11229</span>      <span class="token number">1</span>  <span class="token number">0</span> 09:51 ?        00:00:00 redis-server <span class="token number">192.168</span>.234.131:7006 <span class="token punctuation">[</span>cluster<span class="token punctuation">]</span>
root      <span class="token number">11240</span>   <span class="token number">7691</span>  <span class="token number">0</span> 09:52 pts/0    00:00:00 <span class="token function">grep</span> <span class="token parameter variable">--color</span><span class="token operator">=</span>auto redis
<span class="token punctuation">[</span>root@zhuxm01 redis<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>第四步：创建集群</p> <p>在redis/bin下执行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>./redis-cli <span class="token parameter variable">--cluster</span> create <span class="token number">192.168</span>.88.100:7001 <span class="token punctuation">\</span>
<span class="token number">192.168</span>.88.100:7002 <span class="token punctuation">\</span>
<span class="token number">192.168</span>.88.100:7003 <span class="token punctuation">\</span>
<span class="token number">192.168</span>.88.100:7004 <span class="token punctuation">\</span>
<span class="token number">192.168</span>.88.100:7005 <span class="token punctuation">\</span>
<span class="token number">192.168</span>.88.100:7006 <span class="token punctuation">\</span>
--cluster-replicas <span class="token number">1</span>    
<span class="token comment"># (每个主节点有一个从节点)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Performing <span class="token builtin class-name">hash</span> slots allocation on <span class="token number">6</span> nodes<span class="token punctuation">..</span>.
Master<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Slots <span class="token number">0</span> - <span class="token number">5460</span>
Master<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Slots <span class="token number">5461</span> - <span class="token number">10922</span>
Master<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> -<span class="token operator">&gt;</span> Slots <span class="token number">10923</span> - <span class="token number">16383</span>
Adding replica <span class="token number">192.168</span>.234.131:7005 to <span class="token number">192.168</span>.234.131:7001
Adding replica <span class="token number">192.168</span>.234.131:7006 to <span class="token number">192.168</span>.234.131:7002
Adding replica <span class="token number">192.168</span>.234.131:7004 to <span class="token number">192.168</span>.234.131:7003
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Trying to optimize slaves allocation <span class="token keyword">for</span> anti-affinity
<span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> Some slaves are <span class="token keyword">in</span> the same <span class="token function">host</span> as their master
M: 7e88abdfa256140ab11dc3c2173b00c5868a0479 <span class="token number">192.168</span>.234.131:7001
   slots:<span class="token punctuation">[</span><span class="token number">0</span>-5460<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
M: e5845e3494d58b5400fa21d4b3c34ccafce43024 <span class="token number">192.168</span>.234.131:7002
   slots:<span class="token punctuation">[</span><span class="token number">5461</span>-10922<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5462</span> slots<span class="token punctuation">)</span> master
M: 5dbec321866665aceb8ae0c6791e2ded39464368 <span class="token number">192.168</span>.234.131:7003
   slots:<span class="token punctuation">[</span><span class="token number">10923</span>-16383<span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token number">5461</span> slots<span class="token punctuation">)</span> master
S: 8ad824d12b9f1a16a75e227266e9940aa8610422 <span class="token number">192.168</span>.234.131:7004
   replicates 5dbec321866665aceb8ae0c6791e2ded39464368
S: 8ca84b32509e178181585206eaa736c6323dbd3a <span class="token number">192.168</span>.234.131:7005
   replicates 7e88abdfa256140ab11dc3c2173b00c5868a0479
S: 7a518a28534593c44694215e3a83b3311704e4d4 <span class="token number">192.168</span>.234.131:7006
   replicates e5845e3494d58b5400fa21d4b3c34ccafce43024
Can I <span class="token builtin class-name">set</span> the above configuration? <span class="token punctuation">(</span>type <span class="token string">'yes'</span> to accept<span class="token punctuation">)</span>: <span class="token function">yes</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Nodes configuration updated
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Assign a different config epoch to each <span class="token function">node</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> Sending CLUSTER MEET messages to <span class="token function">join</span> the cluster
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>第五步：连接集群</p> <div class="language-she line-numbers-mode"><pre class="language-text"><code>./redis-cli  -p 7002 -c
补充：观察节点详情 ，先通过客户端连接, info replication
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>补充：经常使用 netstat -nltp，查看端口情况！！！</p> <h2 id="分布式集群-java客户端连接"><a href="#分布式集群-java客户端连接" class="header-anchor">#</a> 分布式集群(java客户端连接)</h2> <h4 id="基于springboot-2"><a href="#基于springboot-2" class="header-anchor">#</a> 基于springboot</h4> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>spring:
  redis:
    cluster:
      nodes:
        - 192.168.30.128:7001
        - 192.168.30.128:7002
        - 192.168.30.128:7003
        - 192.168.30.128:7004
        - 192.168.30.128:7005
        - 192.168.30.128:7006
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-xml line-numbers-mode"><pre class="language-xml"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-xml line-numbers-mode"><pre class="language-xml"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="_14-redis缓存三类问题-重点"><a href="#_14-redis缓存三类问题-重点" class="header-anchor">#</a> 14：Redis缓存三类问题    !!!重点</h1> <h2 id="_14-1-缓存击穿"><a href="#_14-1-缓存击穿" class="header-anchor">#</a> 14.1：缓存击穿</h2> <p><strong>面试题： 热点key失效，持续的高并发访问击破redis缓存，直接访问数据库</strong></p> <p><strong>解决方案：线程同步   单体项目用 synchronize或者redis 分布式锁    setIfAbsent()</strong></p> <blockquote><p><code>某一个</code>热点key，在<code>失效的一瞬间</code>，持续的高并发访问<code>击破缓存</code>直接访问数据库，导致数据库的周期性压力（极端情况下导致数据库宕机）</p></blockquote> <p>缓存击穿演示</p> <blockquote><p>jmeter :压力测试工具，可以演示高并发场景</p></blockquote> <p>创建测试计划</p> <p><img src="/assets/img/image-20210112092515437.d7ce0476.png" alt="image-20210112092515437"></p> <p>创建线程组</p> <p><img src="/assets/img/image-20210112092600864.2944b7b6.png" alt="image-20210112092600864"></p> <p><img src="/assets/img/image-20210112092826621.73350d7b.png" alt="image-20210112092826621"></p> <p>创建http请求</p> <p><img src="/assets/img/image-20210112092908877.a4d6cb10.png" alt="image-20210112092908877"></p> <p><img src="/assets/img/image-20210112093022444.217d3c4c.png" alt="image-20210112093022444"></p> <p>监听http请求的结果</p> <p><img src="/assets/img/image-20210112093121326.c4063dee.png" alt="image-20210112093121326"></p> <p>开始压力测试</p> <p><img src="/assets/img/image-20210112093216360.e3dd7215.png" alt="image-20210112093216360"></p> <p>缓存击穿解决办法:</p> <blockquote><p>加锁(分布式锁)，两次判断</p></blockquote> <div class="language-java line-numbers-mode"><pre class="language-java"><code>  <span class="token keyword">public</span>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllDicts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BoundValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisCache <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span><span class="token string">&quot;dicts666&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//查数据</span>
          <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">//this当前对象 spring的bean默认的声明单例singleton,prototype</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//查数据</span>
                  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> dicts1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  redisCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toJsonStr</span><span class="token punctuation">(</span>dicts1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">return</span> dicts1<span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from redis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token class-name">String</span> s <span class="token operator">=</span> redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token comment">//hutool中的方法转化</span>
                  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> lists <span class="token operator">=</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token class-name">Dict</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">return</span> lists<span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment">//查redis</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from redis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> s <span class="token operator">=</span> redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//hutool中的方法转化</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> lists <span class="token operator">=</span> <span class="token class-name">JSONUtil</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token class-name">Dict</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> lists<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_14-2-缓存穿透"><a href="#_14-2-缓存穿透" class="header-anchor">#</a> 14.2：缓存穿透</h2> <blockquote><p><strong>缓存穿透：热点数据在缓存和数据库中不存在，缓存和数据库都无法命中，每次请求压力都会到数据</strong></p> <p>请求的某个热点数据、数据库并不存在，缓存也无法命中，请求都会到数据源，从而可能压垮数据源</p> <p>数据库中没有，同时Redis中也没有</p></blockquote> <h4 id="方案1-缓存空值"><a href="#方案1-缓存空值" class="header-anchor">#</a> 方案1：缓存空值</h4> <p>不能根本上解决缓存穿透的问题（key变化，还是要去查db，导致redis中会大量的无用数据）</p> <h4 id="方案2-布隆过滤器"><a href="#方案2-布隆过滤器" class="header-anchor">#</a> 方案2：布隆过滤器</h4> <h4 id="有没有的问题"><a href="#有没有的问题" class="header-anchor">#</a> （有没有的问题）</h4> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBloomFilter</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">DictMapper</span> dictMapper<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RBloomFilter</span> <span class="token function">getRedissonClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">useSingleServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span><span class="token string">&quot;redis://192.168.88.100:6379&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedissonClient</span> redissonClient <span class="token operator">=</span> <span class="token class-name">Redisson</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RBloomFilter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> bloomdicts <span class="token operator">=</span> redissonClient<span class="token punctuation">.</span><span class="token function">getBloomFilter</span><span class="token punctuation">(</span><span class="token string">&quot;dicts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//向布隆过滤器中放值，放 数据库中的值</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> dicts1 <span class="token operator">=</span> dictMapper<span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bloomdicts<span class="token punctuation">.</span><span class="token function">tryInit</span><span class="token punctuation">(</span><span class="token number">100000000L</span><span class="token punctuation">,</span><span class="token number">0.03</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dicts1<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>dict <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            bloomdicts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">getDictcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span>  bloomdicts<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span>  <span class="token class-name">String</span> <span class="token function">getDictValueByCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BoundValueOperations</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisCache <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">boundValueOps</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//查数据</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>rBloomFilter<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
              <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from db&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dict</span><span class="token punctuation">&gt;</span></span> queryWrapper  <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              queryWrapper<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;dictcode&quot;</span><span class="token punctuation">,</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token class-name">Dict</span> dict <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseMapper<span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">if</span><span class="token punctuation">(</span>dict<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                  redisCache<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>dict<span class="token punctuation">.</span><span class="token function">getDictvalue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                  <span class="token keyword">return</span>  dict<span class="token punctuation">.</span><span class="token function">getDictvalue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;BloomFilter work&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">return</span>  <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment">//查redis</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;query from redis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> dictvalue <span class="token operator">=</span> redisCache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dictvalue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_14-3-缓存雪崩"><a href="#_14-3-缓存雪崩" class="header-anchor">#</a> 14.3：缓存雪崩</h2> <blockquote><p>当redis服务器重启或者大量缓存集中在某一个时间段失效,即使不是高并发、访问量大，导致数据库访问压力大</p></blockquote> <p>解决方案</p> <blockquote><p>让过期时间平均分布   过期时间=预设置的过期时间+随机数</p></blockquote> <h1 id="_15-面试题"><a href="#_15-面试题" class="header-anchor">#</a> 15：面试题</h1> <h2 id="_15-1-redis内存满了怎么办"><a href="#_15-1-redis内存满了怎么办" class="header-anchor">#</a> 15.1：Redis内存满了怎么办？</h2> <p><strong>面试题:  Redis内存满了，怎么处理？</strong></p> <p><strong>加内存，修改maxmemory</strong></p> <h3 id="_1、通过配置文件配置"><a href="#_1、通过配置文件配置" class="header-anchor">#</a> 1、通过配置文件配置</h3> <p>通过在Redis安装目录下面的<strong>redis.conf</strong>配置文件中添加以下配置设置内存大小，永久性生效</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//设置Redis最大占用内存大小为100M
maxmemory 100mb           
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_2、通过命令修改"><a href="#_2、通过命令修改" class="header-anchor">#</a> 2、通过命令修改</h3> <p>Redis支持运行时通过命令动态修改内存大小 ，临时性的，重启后失效</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>//设置Redis最大占用内存大小为100M    
127.0.0.1:6379&gt; config set maxmemory 100mb
//获取设置的Redis能使用的最大内存大小
127.0.0.1:6379&gt; config get maxmemory
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>如果不设置最大内存大小或者设置最大内存大小为0，在64位操作系统下不限制内存大小，在32位操作系统下最多使用3GB内存</p></blockquote> <h3 id="redis的内存淘汰"><a href="#redis的内存淘汰" class="header-anchor">#</a> Redis的内存淘汰</h3> <p>lRU:最近最少访问</p> <blockquote><p>既然可以设置Redis最大占用内存大小，那么配置的内存就有用完的时候。那在内存用完的时候，还继续往Redis里面添加数据不就没内存可用了吗？</p></blockquote> <p>实际上Redis定义了几种策略用来处理这种情况：</p> <ul><li><strong>noeviction(默认策略)：对于写请求不再提供服务，直接返回错误（DEL请求和部分特殊请求除外</strong>）!!!</li> <li><strong>allkeys-lru</strong>：<strong>从所有key中使用LRU算法进行淘汰,LRU(Least Recently Used)</strong> !!!</li> <li><strong>volatile-lru</strong>：<strong>从设置了过期时间的key中使用LRU算法进行淘汰</strong>,<strong>LRU(Least Recently Used)</strong> !!!</li> <li>allkeys-random：从所有key中随机淘汰数据</li> <li>volatile-random：从设置了过期时间的key中随机淘汰</li> <li><strong>volatile-ttl</strong>：<strong>在设置了过期时间的key中，根据key的过期时间进行淘汰，越早过期的越优先被淘汰</strong> !!!</li></ul> <blockquote><p>当使用<strong>volatile-lru</strong>、<strong>volatile-random</strong>、<strong>volatile-ttl</strong>这三种策略时，如果没有key可以被淘汰，则和<strong>noeviction</strong>一样返回错误</p></blockquote> <h3 id="如何获取及设置内存淘汰策略"><a href="#如何获取及设置内存淘汰策略" class="header-anchor">#</a> 如何获取及设置内存淘汰策略</h3> <p>获取当前内存淘汰策略：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt; config get maxmemory-policy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过配置文件设置淘汰策略（修改<strong>redis.conf</strong>文件）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>maxmemory-policy allkeys-lru
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>通过命令修改淘汰策略：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt; config set maxmemory-policy allkeys-lru
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_15-2-为什么删除数据后-redis内存占用依然很高"><a href="#_15-2-为什么删除数据后-redis内存占用依然很高" class="header-anchor">#</a> 15.2：为什么删除数据后，Redis内存占用依然很高？</h2> <p><strong>为什么会出现碎片，内存默认分配策略是jemalloc，固定大小</strong></p> <p><strong>怎么查看内存碎片，info memory</strong></p> <p><strong>清理内存碎片，activedefrag</strong></p> <h3 id="_1-什么是内存碎片"><a href="#_1-什么是内存碎片" class="header-anchor">#</a> 1.什么是内存碎片？</h3> <p>内存碎片这个概念应该不是第一听说了，熟悉JVM或者操作系统的应该都熟悉，以火车卖票为例，一个车厢<code>128</code>个车位，由于高峰期，只剩余<code>两个</code>位置了，但是此时<code>三个</code>人想要坐在一起，能够吹吹牛批，喝喝酒的，那么这三个人肯定不会买这节车厢的两个位置了，此时这两个位置可以称之为座位碎片 。</p> <h3 id="_2-为什么会出现内存碎片"><a href="#_2-为什么会出现内存碎片" class="header-anchor">#</a> 2.为什么会出现内存碎片</h3> <p><code>Redis</code>提供了多种的内存分配策略，比如<code>libc</code>、<code>jemalloc</code>、<code>tcmalloc</code>，默认使用<code>jemalloc</code>。</p> <p><code>jemalloc</code>这种分配策略并不是按需分配，而是固定大小分配，比如8字节、32字节....2KB、4KB等  !!!</p> <p><img src="/assets/img/image-20210111221708703.794d8bc9.png" alt="image-20210111221708703"></p> <h3 id="_3-如何判断存在内存碎片"><a href="#_3-如何判断存在内存碎片" class="header-anchor">#</a> 3.如何判断存在内存碎片？</h3> <blockquote><p>这个对于运维人员来说很重要，一旦出现Redis运行缓慢或者阻塞了，一定需要先判断内存的占用情况，而不是重启Redis。</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>INFO memory     <span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span>
<span class="token comment"># Memory</span>
used_memory:1073741736  <span class="token comment">#实际使用的内存大小</span>
used_memory_human:1024.00M <span class="token comment">#人类有好的方式</span>
used_memory_rss:1997159792  <span class="token comment">#操作系统实际内存分配</span>
used_memory_rss_human:1.86G
…
mem_fragmentation_ratio:1.86 <span class="token comment">##碎片率</span>
mem_fragmentation_ratio这个指标很清楚的展示了当前内存的碎片率，比如Redis申请了1000字节，但是操作系统实际分配的内存1800个字节，则mem_fragmentation_ratio<span class="token operator">=</span><span class="token number">1800</span>/1000<span class="token operator">=</span><span class="token number">1.8</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_4-如何清理内存碎片"><a href="#_4-如何清理内存碎片" class="header-anchor">#</a> 4.如何清理内存碎片？</h3> <p>Redis提供了参数配置，可以控制清除内存碎片的时机，命令如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>config set activedefrag yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以上命令启动自动清理，但是具体什么时候清理，还要受以下两个参数的影响：</p> <ol><li><code>active-defrag-ignore-bytes 400mb</code>：如果内存碎片达到了<code>400mb</code>，开始清理（自定义）</li> <li><code>active-defrag-threshold-lower 20</code>：内存碎片空间占操作系统分配给 Redis 的总空间比例达到<code>20%</code>时，开始清理（自定义）</li></ol> <p><img src="/assets/img/image-20210111222416717.0eea5c8f.png" alt="image-20210111222416717"></p> <h2 id="_15-3-redis6的新特性"><a href="#_15-3-redis6的新特性" class="header-anchor">#</a> 15.3：Redis6的新特性</h2> <p>redis 主线程只有一个，不存在线程并发问题</p> <p><strong>清楚Redis6支持多线程</strong>       多线程并不是指的主线程，io线程数</p> <h4 id="redis-6-0-新特性-多线程"><a href="#redis-6-0-新特性-多线程" class="header-anchor">#</a> Redis 6.0 新特性-多线程</h4> <p>1：严格来讲从Redis4.0之后并不是单线程，除了主线程外，它也有后台线程在处理一些较为缓慢的操作，例如清理脏数据、无用连接的释放、大 key 的删除等等</p> <p>2：Redis多线程主要解决网络IO瓶颈，并不是解决CPU瓶颈</p> <p><img src="/assets/img/image-20210831173947595.14dd8f35.png" alt="image-20210831173947595"></p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>从上面的实现机制可以看出，Redis的多线程部分只是用来处理网络数据的读写和协议解析，执行命令仍然是单线程顺序执行。所以我们不需要去考虑控制并发及线程安全问题。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3.Redis6.0默认是否开启了多线程？</p> <p>Redis6.0的多线程默认是禁用的，只使用主线程。如需开启需要修改redis.conf配置文件：</p> <p>io-threads-do-reads yes
<img src="https://img-blog.csdnimg.cn/20200505205508583.png" alt="在这里插入图片描述"></p> <p>4.Redis6.0多线程开启时，线程数如何设置？</p> <p>开启多线程后，还需要设置线程数，否则是不生效的。同样修改redis.conf配置文件
<img src="https://img-blog.csdnimg.cn/20200505205541814.png" alt="在这里插入图片描述">
关于线程数的设置，官方有一个建议：4核的机器建议设置为2或3个线程，8核的建议设置为6个线程，线程数一定要小于机器核数。还需要注意的是，线程数并不是越大越好，官方认为超过了8个基本就没什么意义了。</p> <h4 id="redis6新特性-acl"><a href="#redis6新特性-acl" class="header-anchor">#</a> redis6新特性-acl</h4> <p><strong>acl: 创建用户，设置用户权限</strong></p> <p>Redis6之前Redis就只有一个用户(default)权限最高，通过配置文件的requirepass配置</p> <p>Redis6版本推出了<strong>ACL(Access Control List)访问控制权限</strong>的功能，基于此功能，我们可以设置多个用户，为了保证<strong>向下兼容</strong>，Redis6保留了default用户和使用requirepass的方式给default用户设置密码，默认情况下default用户拥有Redis最大权限，我们使用redis-cli连接时如果没有指定用户名，用户也是默认default</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>ACL常用命令
ACL <span class="token function">whoami</span>
ACL list
ACL setuser allen on <span class="token operator">&gt;</span><span class="token number">123456</span>  ~* +@all
AUTH allen mypasswd

<span class="token comment">#只能创建以lakers为前缀的key        </span>
ACL setuser james on <span class="token operator">&gt;</span><span class="token number">123456</span>  ~lakers* +@all
<span class="token comment">#不拥有set权限</span>
ACL setuser james <span class="token parameter variable">-SET</span>

ACL DELUSER james
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="_15-4-面试题"><a href="#_15-4-面试题" class="header-anchor">#</a> 15.4：面试题</h2> <p><strong>Redis：基于内存的非关系型数据库</strong></p> <p><strong>关系型数据库:Mysql  Oracle DB2 SqlServer     (标准的Sql    )</strong></p> <p><strong>非关系型数据库：Redis   MQ  ES</strong></p> <p><strong>常用命令: flushdb/  flushall /  keys * (查看当前库key)/exists key / expire key seconds</strong></p> <p><strong>redis常用的数据类型： string  list  set  zset  hash</strong></p> <p><strong>Redis事务在编译时有效，运行时无效</strong></p> <p><strong>redis: multi / exec /discard</strong></p> <p><strong>mysql:  begin transaction/ commit/ rollback</strong></p> <p><strong>Hutool发http请求（HttpUtil)</strong></p> <p><strong>json串转bean   toBean()</strong></p> <p>​    <strong>json串转List   toList()</strong></p> <p><strong>bean/list转json串  toJsonStr()</strong></p> <p><strong>redis持久化方案: RDB 和 AOF</strong></p> <p><strong>RDB：自动触发      多少秒后多少key变化，自动触发</strong></p> <p>​           <strong>手动触发     flushdb  shutdown   save  bgsave</strong></p> <p>​          <strong>RDB方案无法保证数据的不丢失</strong></p> <p><strong>AOF： 能保证数据的不丢失 ,默认是关闭的   （存储方式设置:always）</strong></p> <p><strong>如何避免redis中key过量的问题?</strong></p> <p><strong>1)用hash 、list 、set、zset数据类型</strong></p> <p><strong>2)给key设置过期时间</strong></p> <p><strong>3)分布式集群</strong></p> <p><strong>redis哨兵模式监控主节点是否处于离线状态，如是则会从从节点中投票产生出新的主节点，从而保证集群的高可用性</strong></p> <p><strong>redis缓存的三类问题：</strong></p> <p>​    <strong>缓存击穿：缓存中没有，数据库中有    ，解决方案加线程锁</strong></p> <p><strong>缓存穿透： 缓存中没有，数据库中没有  ，解决方案布隆过滤器</strong></p> <p><strong>缓存雪崩：大量key集中失效   ，解决方案让过期时间平均分布</strong></p> <hr> <p><strong>如何设置, maxmemory-policy</strong></p> <p><strong>内存占用过高:</strong></p> <p><strong>1)调最大内存大小   maxmemory</strong></p> <p>**2）设置淘汰策略   maxmemory-policy  **</p> <p><strong>常用淘汰策略:noeviction、allkeys-lru、volatile-lru、volatile-ttl</strong></p> <p><strong>3)清理内存碎片</strong></p> <p><strong>内存碎片：</strong></p> <p><strong>为什么会出现碎片，内存默认分配策略是jemalloc，固定大小</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2024/4/13</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/中间件/ELK/使用docker搭建ELK.html" class="prev">
          ELK搭建(Docker版本)
        </a></span> <span class="next"><a href="/中间件/redis/布隆过滤器.html">
          布隆过滤器
        </a>
        →
      </span></p></div> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><div class="option-box-toc-fixed"><div class="toc-container-sidebar"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:650px"><div style="font-weight:bold;text-align:center;">Redis</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-1-redis简介" class="toc-sidebar-link">2.1：Redis简介</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-2-redis特性" class="toc-sidebar-link">2.2：Redis特性</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-3-redis-使用场景" class="toc-sidebar-link">2.3：Redis:使用场景</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#window安装redis" class="toc-sidebar-link">Window安装Redis</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#docker安装redis" class="toc-sidebar-link">docker安装Redis</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#linux安装redis" class="toc-sidebar-link">Linux安装Redis</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-1-string" class="toc-sidebar-link">4.1：String</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-2-list" class="toc-sidebar-link">4.2：List</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-3-set" class="toc-sidebar-link">4.3：Set</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-4-hash" class="toc-sidebar-link">4.4：Hash</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-5-zset-sorted-set" class="toc-sidebar-link">4.5：Zset(sorted set)</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#pom依赖" class="toc-sidebar-link">pom依赖</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#java代码" class="toc-sidebar-link">java代码</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_8-1-基于springboot-重点" class="toc-sidebar-link">8.1：基于springboot    (重点)</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_9-1-短信验证码" class="toc-sidebar-link">9.1：短信验证码</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_9-2-redis查询缓存" class="toc-sidebar-link">9.2：Redis查询缓存</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_10-1-rdb" class="toc-sidebar-link">10.1：RDB</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#rdb持久化方案的特点" class="toc-sidebar-link">RDB持久化方案的特点</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#rdb相关配置" class="toc-sidebar-link">rdb相关配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#触发方式" class="toc-sidebar-link">触发方式</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_10-2-aof" class="toc-sidebar-link">10.2：AOF</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#aof持久化方案的特点" class="toc-sidebar-link">AOF持久化方案的特点</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#aof相关配置" class="toc-sidebar-link">AOF相关配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#触发方式-2" class="toc-sidebar-link">触发方式</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#aof重写" class="toc-sidebar-link">AOF重写</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_10-3-rdb对比aof" class="toc-sidebar-link">10.3：RDB对比AOF</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#集群配置" class="toc-sidebar-link">集群配置</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#哨兵模式介绍" class="toc-sidebar-link">哨兵模式介绍</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#哨兵模式配置" class="toc-sidebar-link">哨兵模式配置</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#基于springboot" class="toc-sidebar-link">基于springboot</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#分布式集群架构" class="toc-sidebar-link">分布式集群架构</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#分布式集群搭建" class="toc-sidebar-link">分布式集群搭建</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#分布式集群-java客户端连接" class="toc-sidebar-link">分布式集群(java客户端连接)</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_14-1-缓存击穿" class="toc-sidebar-link">14.1：缓存击穿</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_14-2-缓存穿透" class="toc-sidebar-link">14.2：缓存穿透</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_14-3-缓存雪崩" class="toc-sidebar-link">14.3：缓存雪崩</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-1-redis内存满了怎么办" class="toc-sidebar-link">15.1：Redis内存满了怎么办？</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_1、通过配置文件配置" class="toc-sidebar-link">1、通过配置文件配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2、通过命令修改" class="toc-sidebar-link">2、通过命令修改</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#redis的内存淘汰" class="toc-sidebar-link">Redis的内存淘汰</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#如何获取及设置内存淘汰策略" class="toc-sidebar-link">如何获取及设置内存淘汰策略</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-2-为什么删除数据后-redis内存占用依然很高" class="toc-sidebar-link">15.2：为什么删除数据后，Redis内存占用依然很高？</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_1-什么是内存碎片" class="toc-sidebar-link">1.什么是内存碎片？</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-为什么会出现内存碎片" class="toc-sidebar-link">2.为什么会出现内存碎片</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_3-如何判断存在内存碎片" class="toc-sidebar-link">3.如何判断存在内存碎片？</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-如何清理内存碎片" class="toc-sidebar-link">4.如何清理内存碎片？</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-3-redis6的新特性" class="toc-sidebar-link">15.3：Redis6的新特性</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-4-面试题" class="toc-sidebar-link">15.4：面试题</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">Redis</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-1-redis简介" class="toc-sidebar-link">2.1：Redis简介</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-2-redis特性" class="toc-sidebar-link">2.2：Redis特性</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-3-redis-使用场景" class="toc-sidebar-link">2.3：Redis:使用场景</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#window安装redis" class="toc-sidebar-link">Window安装Redis</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#docker安装redis" class="toc-sidebar-link">docker安装Redis</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#linux安装redis" class="toc-sidebar-link">Linux安装Redis</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-1-string" class="toc-sidebar-link">4.1：String</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-2-list" class="toc-sidebar-link">4.2：List</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-3-set" class="toc-sidebar-link">4.3：Set</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-4-hash" class="toc-sidebar-link">4.4：Hash</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-5-zset-sorted-set" class="toc-sidebar-link">4.5：Zset(sorted set)</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#pom依赖" class="toc-sidebar-link">pom依赖</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#java代码" class="toc-sidebar-link">java代码</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_8-1-基于springboot-重点" class="toc-sidebar-link">8.1：基于springboot    (重点)</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_9-1-短信验证码" class="toc-sidebar-link">9.1：短信验证码</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_9-2-redis查询缓存" class="toc-sidebar-link">9.2：Redis查询缓存</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_10-1-rdb" class="toc-sidebar-link">10.1：RDB</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#rdb持久化方案的特点" class="toc-sidebar-link">RDB持久化方案的特点</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#rdb相关配置" class="toc-sidebar-link">rdb相关配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#触发方式" class="toc-sidebar-link">触发方式</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_10-2-aof" class="toc-sidebar-link">10.2：AOF</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#aof持久化方案的特点" class="toc-sidebar-link">AOF持久化方案的特点</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#aof相关配置" class="toc-sidebar-link">AOF相关配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#触发方式-2" class="toc-sidebar-link">触发方式</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#aof重写" class="toc-sidebar-link">AOF重写</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_10-3-rdb对比aof" class="toc-sidebar-link">10.3：RDB对比AOF</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#集群配置" class="toc-sidebar-link">集群配置</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#哨兵模式介绍" class="toc-sidebar-link">哨兵模式介绍</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#哨兵模式配置" class="toc-sidebar-link">哨兵模式配置</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#基于springboot" class="toc-sidebar-link">基于springboot</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#分布式集群架构" class="toc-sidebar-link">分布式集群架构</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#分布式集群搭建" class="toc-sidebar-link">分布式集群搭建</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#分布式集群-java客户端连接" class="toc-sidebar-link">分布式集群(java客户端连接)</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_14-1-缓存击穿" class="toc-sidebar-link">14.1：缓存击穿</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_14-2-缓存穿透" class="toc-sidebar-link">14.2：缓存穿透</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_14-3-缓存雪崩" class="toc-sidebar-link">14.3：缓存雪崩</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-1-redis内存满了怎么办" class="toc-sidebar-link">15.1：Redis内存满了怎么办？</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_1、通过配置文件配置" class="toc-sidebar-link">1、通过配置文件配置</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2、通过命令修改" class="toc-sidebar-link">2、通过命令修改</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#redis的内存淘汰" class="toc-sidebar-link">Redis的内存淘汰</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#如何获取及设置内存淘汰策略" class="toc-sidebar-link">如何获取及设置内存淘汰策略</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-2-为什么删除数据后-redis内存占用依然很高" class="toc-sidebar-link">15.2：为什么删除数据后，Redis内存占用依然很高？</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_1-什么是内存碎片" class="toc-sidebar-link">1.什么是内存碎片？</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_2-为什么会出现内存碎片" class="toc-sidebar-link">2.为什么会出现内存碎片</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_3-如何判断存在内存碎片" class="toc-sidebar-link">3.如何判断存在内存碎片？</a></li><li class="toc-sidebar-sub-header"><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_4-如何清理内存碎片" class="toc-sidebar-link">4.如何清理内存碎片？</a></li></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-3-redis6的新特性" class="toc-sidebar-link">15.3：Redis6的新特性</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html#_15-4-面试题" class="toc-sidebar-link">15.4：面试题</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box"><img src="/images/system/wechat.png" class="nozoom"> <span class="show-txt">手机看</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.9rem">微信扫一扫</span> <img height="180px" src="https://api.qrserver.com/v1/create-qr-code/?data=https://tec.hjcwzx.top/%E4%B8%AD%E9%97%B4%E4%BB%B6/redis/Redis%E7%AC%94%E8%AE%B0%E5%85%A8.html" style="margin:10px;">
                可以<b>手机看</b>或分享至<b>朋友圈</b></div></div></div></div> <div class="option-box"><img src="/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <div class="option-box"><img src="/images/system/xingqiu.png" width="25px" class="nozoom"> <span class="show-txt">星球</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><img height="180px" src="/images/personal/xingqiu.png" style="margin:10px;"> <b>知识星球</b>：技术侦探
            </div></div></div></div> <div class="option-box"><img src="/images/system/wexin4.png" width="25px" class="nozoom"> <span class="show-txt">交流</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">添加微信一起学习交流</span> <img src="/images/personal/weixin.png" height="180px" style="margin:10px;">
                PS：添加时请备注<b>技术侦探</b>，谢谢！
              </div></div></div></div> <div class="option-box"><img src="/images/system/heart-1.png" width="25px" class="nozoom"> <span class="show-txt">支持我</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">鼓励/支持/赞赏我</span> <img height="180px" src="/images/personal/encourage-head.png" style="margin:5px;"> <br>1. 不靠它生存但仍希望得到你的鼓励；
                <br>2. 时刻警醒自己保持技术人的初心，沉淀，分享，成长；
              </div></div></div></div> <div title="ELK搭建(Docker版本)" class="option-box" style="padding-left:2px;text-align:center;"><a href="/中间件/ELK/使用docker搭建ELK.html"><img src="/images/system/pre2.png" width="30px" class="nozoom"> <span class="show-txt">上一篇</span></a></div> <div title="布隆过滤器" class="option-box" style="padding-left:2px;text-align:center;"><a href="/中间件/redis/布隆过滤器.html"><img src="/images/system/next2.png" width="30px" class="nozoom"> <span class="show-txt">下一篇</span></a></div></div>  <div class="page-side-sitemap"><div class="option-box"><img src="/images/system/sitemap.png" class="nozoom img"> <span class="show-txt">站点图</span> <div class="sitemap-container"><h4>站点导航图
              <a href="/更新日志/更新日志.html" class="sitemap-top-link"> 更新日志</a></h4> <table class="sitemap-table"><tr><td nowrap="nowrap"><div class="sitemap-col-group">常用搜索</div></td> <td><div class="sitemap-col-item"><a href="http://www.baidu.com/" target="_blank" title="百度">
          百度
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.google.com/" target="_blank" title="Google">
          Google
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.bing.com/" target="_blank" title="Bing">
          Bing
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://github.com" target="_blank" title="Github">
          Github
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.programcreek.com/java-api-examples/index.php" target="_blank" title="搜代码">
          搜代码
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></td> <!----></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">技术社区</div></td> <td><div class="sitemap-col-item"><a href="http://www.csdn.net/" target="_blank" title="CDSN">
          CDSN
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="http://www.cnblogs.com/" target="_blank" title="博客园">
          博客园
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.oschina.net" target="_blank" title="OSChina">
          OSChina
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://segmentfault.com/" target="_blank" title="思否">
          思否
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://juejin.im" target="_blank" title="掘金">
          掘金
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.linuxidc.com/" target="_blank" title="Linux公社">
          Linux公社
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://www.ibm.com/developerworks/cn/" target="_blank" title="IBM 开发者">
          IBM 开发者
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="sitemap-col-item"><a href="https://stackoverflow.com" target="_blank" title="StackOverflow">
          StackOverflow
          <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></td> <!----></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">Java相关</div></td> <!----> <td><a href="/java/javaSE基础/01_Java入门与开发环境搭建.html" class="sitemap-col-item">
          JavaSE基础
        </a><a href="/java/JavaSE高级/01_IO.html" class="sitemap-col-item">
          JavaSE高级
        </a><a href="/java/javaWeb/01_Web开发基础.html" class="sitemap-col-item">
          JavaWeb
        </a><a href="/java/JUC/1、JUC概述.html" class="sitemap-col-item">
          JUC
        </a><a href="/java/补充/JVM.html" class="sitemap-col-item">
          JVM
        </a><a href="/java/补充/枚举.html" class="sitemap-col-item">
          ENUM
        </a><a href="/java/补充/线程池.html" class="sitemap-col-item">
          线程池
        </a><a href="/java/补充/自定义注解.html" class="sitemap-col-item">
          自定义注解
        </a><a href="/java/响应式编程/前置知识.html" class="sitemap-col-item">
          响应式编程
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">Spring</div></td> <!----> <td><a href="/框架/Mybatis/01_MyBatis快速入门.html" class="sitemap-col-item">
          Mybatis
        </a><a href="/框架/Mybatis/03_MybatisPlus.html" class="sitemap-col-item">
          Mybatis Plus
        </a><a href="/框架/Spring全家桶/Spring/01_SpringIOC和DI.html" class="sitemap-col-item">
          Spring
        </a><a href="/框架/Spring全家桶/SpringMVC/01_SpringMVC快速入门及解析.html" class="sitemap-col-item">
          Spring MVC
        </a><a href="/框架/Spring全家桶/SpringBoot/01_SpringBoot_入门.html" class="sitemap-col-item">
          Spring Boot
        </a><a href="/框架/Spring全家桶/SpringCloudAlibaba/Nacos.html" class="sitemap-col-item">
          Spring Cloud Alibaba
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">中间件&amp;插件</div></td> <!----> <td><a href="/中间件/maven/01_Maven基础.html" class="sitemap-col-item">
          Maven中央仓库
        </a><a href="/中间件/ElasticSearch/ElasticSearch.html" class="sitemap-col-item">
          ElasticSearch
        </a><a href="/中间件/redis/Redis笔记全.html" class="sitemap-col-item">
          Redis
        </a><a href="/中间件/redis/布隆过滤器.html" class="sitemap-col-item">
          布隆过滤器
        </a><a href="/中间件/rocketMq/RocketMQ.html" class="sitemap-col-item">
          RocketMQ.
        </a><a href="/中间件/git/笔记.html" class="sitemap-col-item">
          git
        </a><a href="/中间件/自定义Starter/自定义starter.html" class="sitemap-col-item">
          自定义starter
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">运维</div></td> <!----> <td><a href="/部署/nginx/Nginx.html" class="sitemap-col-item">
          Nginx
        </a><a href="/部署/docker/docker.html" class="sitemap-col-item">
          Docker
        </a><a href="/部署/linux/01_Linux_安装.html" class="sitemap-col-item">
          Linux
        </a><a href="/部署/vm/linux安装centos.html" class="sitemap-col-item">
          VM Ware
        </a></td></tr><tr><td nowrap="nowrap"><div class="sitemap-col-group">面向对象</div></td> <!----> <td><a href="/设计模式/创建型模式/" class="sitemap-col-item">
          设计模式
        </a></td></tr></table></div></div></div> <!----> </aside></div><div class="global-ui"><div class="read-more-wrap" style="display:none;position:absolute;bottom:0px;z-index:9999;width:100%;margin-top:-100px;font-family:PingFangSC-Regular, sans-serif;"><div id="read-more-mask" style="position: relative; height: 200px; background: -webkit-gradient(linear, 0 0%, 0 100%, from(rgba(255, 255, 255, 0)), to(rgb(255, 255, 255)));"></div> <a id="read-more-btn" target="_self" style="position: absolute; left: 50%; top: 70%; bottom: 30px;\n        transform: translate(-50%, -50%); width: 160px; height: 36px;\n         line-height: 36px; font-size: 15px; text-align: center;\n          border: 1px solid rgb(222, 104, 109); color: rgb(222, 104, 109);\n           background: rgb(255, 255, 255); cursor: pointer; border-radius: 6px;">阅读全文</a> <div id="btw-modal-wrap" style="display: none;"><div id="btw-mask" style="position: fixed; top: 0px; right: 0px; bottom: 0px; left: 0px; opacity: 0.7; z-index: 999; background: rgb(0, 0, 0);"></div> <div id="btw-modal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 300px; text-align: center; font-size: 13px; background: rgb(255, 255, 255); border-radius: 10px; z-index: 9999; font-family: PingFangSC-Regular, sans-serif;"><span id="btw-modal-close-btn" style="position: absolute; top: 5px; right: 15px; line-height: 34px; font-size: 34px; cursor: pointer; opacity: 0.2; z-index: 9999; color: rgb(0, 0, 0); background: none; border: none; outline: none;">×</span> <p id="btw-modal-header" style="margin-top: 40px; line-height: 1.8; font-size: 13px;">
            微信扫码或搜索：<span style="color: #E9405A; font-weight: bold;">智慧对话的未来</span> <br>发送：<span id="hutec-token" class="token" style="color: #e9415a; font-weight: bold; font-size: 17px; margin-bottom: 45px;">}</span> <br>即可<span style="color: #e9415a; font-weight: bold;">立即永久</span>解锁本站全部文章</p> <img src="/images/personal/qrcode.png" style="width: 180px; margin-top: 10px; margin-bottom: 30px; border: 8px solid rgb(230, 230, 230);"></div></div></div></div></div>
    <script src="/assets/js/cg-styles.js?v=1719459192901" defer></script><script src="/assets/js/cg-4.js?v=1719459192901" defer></script><script src="/assets/js/cg-22.js?v=1719459192901" defer></script><script src="/assets/js/cg-1.js?v=1719459192901" defer></script><script src="/assets/js/cg-88.js?v=1719459192901" defer></script><script src="/assets/js/cg-app.js?v=1719459192901" defer></script>
  </body>
</html>
